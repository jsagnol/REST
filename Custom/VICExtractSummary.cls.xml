<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="Custom.VICExtractSummary">
<Description>
Version 3.3
TRC 23657	25/06/2008 Extract Summaries
TRC 23657	11/07/2008
TRC 23657	21/07/2008
TRC 23657	19/08/2008 (TRC's 25314,25315,25316,25317,25318)
TRC 25919,TRC 25926 05/09/2008
TRC 26460	25/09/2008
TRC 27310	12/12/2008
TRC	28929	03/03/2009
TRC 32035	24/04/2009
TRC 34689	14/07/2009	Added transmission check to PHMPR
			22/12/2009	Defined repid1 so summary can be run independent of the extract
TRC 48682 30/06/2010
TRC 48682 02/07/2010
TRC 50425 02/07/2010
TRC 36835 26/07/2010
TRC 36835 23/11/2010
	TRC 67816 22/03/2011
TRC78269	24/08/2011 Correct summary counts
TRC88408	31/10/2011 If more than 1 element 2 for an STO then create new row in summary
TRC88408	03/11/2011 Summary moved to VICQDCExtract</Description>
<ClassType/>
<ProcedureBlock>0</ProcedureBlock>
<Super>%Library.RegisteredObject</Super>
<TimeCreated>61153,52811.238985</TimeCreated>

<Parameter name="SrcVer">
<Description>
Location and Revision of this file in Perforce (Auto-updating)</Description>
<Default>$Id: //custom_ccrs/au/AUSW/T2016/BASE/cls/Custom/VICExtractSummary.xml#1 $</Default>
</Parameter>

<Method name="GetActualCode">
<ClassMethod>1</ClassMethod>
<FormalSpec>TableName:%Library.String,FieldName:%Library.String,ReportType:%Library.String,MappedValue:%Library.String</FormalSpec>
<ReturnType>%Library.String</ReturnType>
<Implementation><![CDATA[
	n ActualValue
	s ActualValue=""
	i MappedValue'="" s query="SELECT NATC_ActualValue FROM SQLUser.PAC_NationalCodes WHERE NATC_TableName='"_TableName_"' AND NATC_FieldName='"_FieldName_"' AND NATC_ReportingType_DR->REPTYPE_Code='"_ReportType_"' AND NATC_MappedValue='"_MappedValue_"' AND NATC_DateTo IS NULL"
	i MappedValue="" s query="SELECT NATC_ActualValue FROM SQLUser.PAC_NationalCodes WHERE NATC_TableName='"_TableName_"' AND NATC_FieldName='"_FieldName_"' AND NATC_ReportingType_DR->REPTYPE_Code='"_ReportType_"' AND NATC_MappedValue IS NULL AND NATC_DateTo IS NULL"
	s rset = ##class(%ResultSet).%New()
	d rset.Prepare(query)
	d rset.Execute()
	while rset.Next() {
		s ActualValue=rset.Data("NATC_ActualValue")
	}
	d rset.Close()
	i $g(ActualValue)="" {
		i MappedValue'="" s query="SELECT NATC_ActualValue FROM SQLUser.PAC_NationalCodes WHERE NATC_TableName='"_TableName_"' AND NATC_FieldName='"_FieldName_"' AND NATC_ReportingType_DR->REPTYPE_Code='CCDS' AND NATC_MappedValue='"_MappedValue_" AND NATC_DateTo IS NULL"
		i MappedValue="" s query="SELECT NATC_ActualValue FROM SQLUser.PAC_NationalCodes WHERE NATC_TableName='"_TableName_"' AND NATC_FieldName='"_FieldName_"' AND NATC_ReportingType_DR->REPTYPE_Code='CCDS' AND NATC_MappedValue IS NULL AND NATC_DateTo IS NULL"
		s rset = ##class(%ResultSet).%New()
		d rset.Prepare(query)
		d rset.Execute()
		while rset.Next() {
			s ActualValue=rset.Data("NATC_ActualValue")
		}
		d rset.Close()
	}

	i $g(ActualValue)="" s ActualValue=MappedValue
	q ActualValue
]]></Implementation>
</Method>

<Method name="HACCSummary">
<ClassMethod>1</ClassMethod>
<FormalSpec>filepath:%Library.String,date:%Library.String,time:%Library.String</FormalSpec>
<Implementation><![CDATA[
 n I49,I50,I51,I52,I53,I54,I55,I56,I57,I58,I59,I60,I61,I62,I63,I64,I65,I66,I67,I68,I69,I70,I71,I72,I73,I74,I75,I76,I77,I78,I79,I80,I81,I82,I83,I84,I85,I86,I87,I103,I104,I105,I106,I107,I108,I109,I110,I111,I112,I113,I114,I117,I118,I119,I120,I121,I122,I123,I124,I125,I126,I127,I128,I129,I130,I131,I132,I133
 s (I49,I50,I51,I52,I53,I54,I55,I56,I57,I58,I59,I60,I61,I62,I63,I64,I65,I66,I67,I68,I69,I70,I71,I72,I73,I74,I75,I76,I77,I78,I79,I80,I81,I82,I83,I84,I85,I86,I87,I103,I104,I105,I106,I107,I108,I109,I110,I111,I112,I113,I114,I117,I118,I119,I120,I121,I122,I123,I124,I125,I126,I127,I128,I129,I130,I131,I132,I133)=0
 
 n I139,I140,I141,I142,I143,I144,I145,I146,I147,I148,I149,I150,I151,I152,I153,I154,I155,I156,I157,I158,I159,I160,I161,I162,I163,I164,I165,I166,I167,I168,I169,I170,I171,I172,I173,I174,I175,I176,I177,I178,I179,I180,I181,I182,I183,I184,I185,I186,I187,I188,I189,I190,I191,I192,I193,I194,I195,I196,I197,I198,I199,I200,I201,I202,I203,I204,I205,I206,I207,I208,I209,I210,I211,I212,I213,I214,I215,I216,I217,I218,I219,I220,I221,I222,I223,I224,I225,I226,I227,I228,I229,I230,I231,I232,I233,I234,I235,I236,I237,I238,I239,I240,I241,I242,I243,I244,I245,I246,I247,I248,I249,I250
 n I251,I252,I254,I255,I256,I257,I258,I259,I260,I261,I262,I263,I264,I265,I266,I267,I268,I269,I270,I271,I272,I273,I274,I275,I276,I277,I278,I279,I280,I281,I282,I283,I284,I285,I286,I287,I288,I289,I290,I291
 
 s (I139,I140,I141,I142,I143,I144,I145,I146,I147,I148,I149,I150,I151,I152,I153,I154,I155,I156,I157,I158,I159,I160,I161,I162,I163,I164,I165,I166,I167,I168,I169,I170,I171,I172,I173,I174,I175,I176,I177,I178,I179,I180,I181,I182,I183,I184,I185,I186,I187,I188,I189,I190,I191,I192,I193,I194,I195,I196,I197,I198,I199,I200,I201,I202,I203,I204,I205,I206,I207,I208,I209,I210,I211,I212,I213,I214,I215,I216,I217,I218,I219,I220,I221,I222,I223,I224,I225,I226,I227,I228,I229,I230,I231,I232,I233,I234,I235,I236,I237,I238,I239,I240,I241,I242,I243,I244,I245,I246,I247,I248,I249,I250)=0
 s (I251,I252,I254,I255,I256,I257,I258,I259,I260,I261,I262,I263,I264,I265,I266,I267,I268,I269,I270,I271,I272,I273,I274,I275,I276,I277,I278,I279,I280,I281,I282,I283,I284,I285,I286,I287,I288,I289,I290,I291)=0
 
 n itemlist,mrid,item,SLK,filename,Total
 s (SLK,filename)=""
 s itemlist="I49,I50,I51,I52,I53,I54,I55,I56,I57,I58,I59,I60,I61,I62,I63,I64,I65,I66,I67,I68,I69,I70,I71,I72,I73,I74,I75,I76,I77,I78,I79,I80,I81,I82,I83,I84,I85,I86,I87,I103,I104,I105,I106,I107,I108,I109,I110,I111,I112,I113,I114,I117,I118,I119,I120,I121,I122,I123,I124,I125,I126,I127,I128,I129,I130,I131,I132,I133"
 
 s repid1=$i(^zCacheTemp("VICHACCSummary"))
 k ^zCacheTemp("VICHACCSummary",repid1)
 
 s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","HACC",date,time,id)) q:id=""  d
 . s patid=$p($g(^Custom.ExtractSummaries(id)),"^",342)
 . s I4=$p($g(^Custom.ExtractSummaries(id)),"^",13)
 . s I5=$p($g(^Custom.ExtractSummaries(id)),"^",14)
 . s I6=$p($g(^Custom.ExtractSummaries(id)),"^",15)
 . s I8=$p($g(^Custom.ExtractSummaries(id)),"^",17)
 . ;
 . s (I49,I50,I51,I52,I53,I54,I55,I56,I57,I58,I59,I60,I61,I62,I63,I64,I65,I66,I67,I68,I69,I70,I71,I72,I73,I74,I75,I76,I77,I78,I79,I80,I81,I82,I83,I84,I85,I86,I87,I103,I104,I105,I106,I107,I108,I109,I110,I111,I112,I113,I114,I117,I118,I119,I120,I121,I122,I123,I124,I125,I126,I127,I128,I129,I130,I131,I132,I133)=""
 . s I49=$p($g(^Custom.ExtractSummaries(id)),"^",60)
 . s I50=$p($g(^Custom.ExtractSummaries(id)),"^",61)
 . s I51=$p($g(^Custom.ExtractSummaries(id)),"^",62)
 . s I52=$p($g(^Custom.ExtractSummaries(id)),"^",63)
 . s I53=$p($g(^Custom.ExtractSummaries(id)),"^",64)
 . s I54=$p($g(^Custom.ExtractSummaries(id)),"^",65)
 . s I55=$p($g(^Custom.ExtractSummaries(id)),"^",66)
 . s I56=$p($g(^Custom.ExtractSummaries(id)),"^",67)
 . s I57=$p($g(^Custom.ExtractSummaries(id)),"^",68)
 . s I58=$p($g(^Custom.ExtractSummaries(id)),"^",69)
 . s I59=$p($g(^Custom.ExtractSummaries(id)),"^",70)
 . s I60=$p($g(^Custom.ExtractSummaries(id)),"^",71)
 . s I61=$p($g(^Custom.ExtractSummaries(id)),"^",72)
 . s I62=$p($g(^Custom.ExtractSummaries(id)),"^",73)
 . s I63=$p($g(^Custom.ExtractSummaries(id)),"^",74)
 . s I64=$p($g(^Custom.ExtractSummaries(id)),"^",75)
 . s I65=$p($g(^Custom.ExtractSummaries(id)),"^",76)
 . s I66=$p($g(^Custom.ExtractSummaries(id)),"^",77)
 . s I67=$p($g(^Custom.ExtractSummaries(id)),"^",78)
 . s I68=$p($g(^Custom.ExtractSummaries(id)),"^",79)
 . s I69=$p($g(^Custom.ExtractSummaries(id)),"^",80)
 . s I70=$p($g(^Custom.ExtractSummaries(id)),"^",81)
 . s I71=$p($g(^Custom.ExtractSummaries(id)),"^",82)
 . s I72=$p($g(^Custom.ExtractSummaries(id)),"^",83)
 . s I73=$p($g(^Custom.ExtractSummaries(id)),"^",84)
 . s I74=$p($g(^Custom.ExtractSummaries(id)),"^",85)
 . s I75=$p($g(^Custom.ExtractSummaries(id)),"^",86)
 . s I76=$p($g(^Custom.ExtractSummaries(id)),"^",87)
 . s I77=$p($g(^Custom.ExtractSummaries(id)),"^",88)
 . s I78=$p($g(^Custom.ExtractSummaries(id)),"^",89)
 . s I79=$p($g(^Custom.ExtractSummaries(id)),"^",90)
 . s I80=$p($g(^Custom.ExtractSummaries(id)),"^",91)
 . s I81=$p($g(^Custom.ExtractSummaries(id)),"^",92)
 . s I82=$p($g(^Custom.ExtractSummaries(id)),"^",93)
 . s I83=$p($g(^Custom.ExtractSummaries(id)),"^",94)
 . s I84=$p($g(^Custom.ExtractSummaries(id)),"^",95)
 . s I85=$p($g(^Custom.ExtractSummaries(id)),"^",96)
 . s I86=$p($g(^Custom.ExtractSummaries(id)),"^",97)
 . s I87=$p($g(^Custom.ExtractSummaries(id)),"^",98)
 . ;s I103=$p($g(^Custom.ExtractSummaries(id)),"^",114)
 . i ($p($g(^Custom.ExtractSummaries(id)),"^",114)="1") s I103=$p($g(^Custom.ExtractSummaries(id)),"^",114)
 . i (($p($g(^Custom.ExtractSummaries(id)),"^",115)="1")||($p($g(^Custom.ExtractSummaries(id)),"^",115)="2")) s I104=$p($g(^Custom.ExtractSummaries(id)),"^",115)
 . s I105=$p($g(^Custom.ExtractSummaries(id)),"^",116)
 . s I106=$p($g(^Custom.ExtractSummaries(id)),"^",117)
 . s I107=$p($g(^Custom.ExtractSummaries(id)),"^",118)
 . s I108=$p($g(^Custom.ExtractSummaries(id)),"^",119)
 . s I109=$p($g(^Custom.ExtractSummaries(id)),"^",120)
 . s I110=$p($g(^Custom.ExtractSummaries(id)),"^",121)
 . s I111=$p($g(^Custom.ExtractSummaries(id)),"^",122)
 . s I112=$p($g(^Custom.ExtractSummaries(id)),"^",123)
 . s I113=$p($g(^Custom.ExtractSummaries(id)),"^",124)
 . s I114=$p($g(^Custom.ExtractSummaries(id)),"^",125)
 . s I117=$p($g(^Custom.ExtractSummaries(id)),"^",128)
 . s I118=$p($g(^Custom.ExtractSummaries(id)),"^",129)
 . s I119=$p($g(^Custom.ExtractSummaries(id)),"^",130)
 . s I120=$p($g(^Custom.ExtractSummaries(id)),"^",131)
 . s I121=$p($g(^Custom.ExtractSummaries(id)),"^",132)
 . s I122=$p($g(^Custom.ExtractSummaries(id)),"^",133)
 . s I123=$p($g(^Custom.ExtractSummaries(id)),"^",134)
 . s I124=$p($g(^Custom.ExtractSummaries(id)),"^",135)
 . s I125=$p($g(^Custom.ExtractSummaries(id)),"^",136)
 . s I126=$p($g(^Custom.ExtractSummaries(id)),"^",137)
 . s I127=$p($g(^Custom.ExtractSummaries(id)),"^",138)
 . s I128=$p($g(^Custom.ExtractSummaries(id)),"^",139)
 . s I129=$p($g(^Custom.ExtractSummaries(id)),"^",140)
 . s I130=$p($g(^Custom.ExtractSummaries(id)),"^",141)
 . s I131=$p($g(^Custom.ExtractSummaries(id)),"^",142)
 . s I132=$p($g(^Custom.ExtractSummaries(id)),"^",143)
 . s I133=$p($g(^Custom.ExtractSummaries(id)),"^",144)
 . ;
 . i I68'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I68")=I68+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I68"))
 . i I60'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I60")=I60+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I60"))
 . i I66'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I66")=I66+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I66"))
 . i I58'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I58")=I58+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I58"))
 . i I67'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I67")=I67+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I67"))
 . i I59'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I59")=I59+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I59"))
 . i I64'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I64")=I64+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I64"))
 . i I56'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I56")=I56+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I56"))
 . i I52'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I52")=I52+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I52"))
 . i I51'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I51")=I51+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I51"))
 . i I62'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I62")=I62+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I62"))
 . i I54'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I54")=I54+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I54"))
 . i I65'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I65")=I65+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I65"))
 . i I57'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I57")=I57+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I57"))
 . i I61'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I61")=I61+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I61"))
 . i I53'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I53")=I53+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I53"))
 . i I63'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I63")=I63+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I63"))
 . i I55'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I55")=I55+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I55"))
 . i I70'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I70")=I70+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I70"))
 . i I71'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I71")=I71+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I71"))
 . i I72'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I72")=I72+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I72"))
 . i I73'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I73")=I73+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I73"))
 . i I49'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I49")=I49+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I49"))
 . i I50'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I50")=I50+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I50"))
 . i I69'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I69")=I69+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I69"))
 . i I74'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I74")=I74+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I74"))
 . i I75'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I75")=I75+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I75"))
 . i I76'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I76")=I76+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I76"))
 . i I77'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I77")=I77+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I77"))
 . i I78'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I78")=I78+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I78"))
 . i I79'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I79")=I79+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I79"))
 . i I80'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I80")=I80+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I80"))
 . i I81'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I81")=I81+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I81"))
 . i I82'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I82")=I82+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I82"))
 . i I83'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I83")=I83+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I83"))
 . i I84'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I84")=I84+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I84"))
 . i I85'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I85")=I85+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I85"))
 . i I86'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I86")=I86+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I86"))
 . i I87'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I87")=I87+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I87"))
 . i I103'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I103")=I103+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I103"))
 . i I104'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I104")=I104+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I104"))
 . i I105'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I105")=I105+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I105"))
 . i I106'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I106")=I106+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I106"))
 . i I107'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I107")=I107+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I107"))
 . i I108'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I108")=I108+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I108"))
 . i I109'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I109")=I109+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I109"))
 . i I110'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I110")=I110+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I110"))
 . i I111'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I111")=I111+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I111"))
 . i I112'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I112")=I112+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I112"))
 . i I113'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I113")=I113+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I113"))
 . i I114'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I114")=I114+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I114"))
 . i I117'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I117")=I117+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I117"))
 . i I118'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I118")=I118+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I118"))
 . i I120'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I120")=I120+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I120"))
 . i I121'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I121")=I121+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I121"))
 . i I119'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I119")=I119+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I119"))
 . i I122'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I122")=I122+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I122"))
 . i I123'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I123")=I123+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I123"))
 . i I125'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I125")=I125+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I125"))
 . i I124'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I124")=I124+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I124"))
 . i I126'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I126")=I126+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I126"))
 . i I127'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I127")=I127+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I127"))
 . i I129'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I129")=I129+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I129"))
 . i I130'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I130")=I130+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I130"))
 . i I128'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I128")=I128+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I128"))
 . i I131'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I131")=I131+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I131"))
 . i I132'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I132")=I132+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I132"))
 . i I133'="" s ^zCacheTemp("VICHACCSummary",repid1,patid,"I133")=I133+$g(^zCacheTemp("VICHACCSummary",repid1,patid,"I133"))
 . ;
 . s mrid=0 f  s mrid=$o(^RT(0,"PAT",patid,mrid)) q:mrid=""  d
 . . i $p($g(^RT(mrid)),"^",6)'="" d
 . . . i $p($g(^RTC("TYPE",$p($g(^RT(mrid)),"^",6))),"^",1)="SLK" d
 . . . . s SLK=$p($g(^RT(mrid)),"^",1)
 . ;
 . s ^zCacheTemp("VICHACCSummary",repid1,"Clients",patid)=$p($g(^PAPER(patid,"ALL")),"^",1)_", "_$p($g(^PAPER(patid,"ALL")),"^",2)_"^"_$p($g(^PAPER(patid,"PAT",1)),"^",1)_"^"_SLK
 
 s Total=0
 s patid=0 f  s patid=$o(^zCacheTemp("VICHACCSummary",repid1,patid)) q:patid=""  d
 . f x=1:1:$l(itemlist,",") d
 . . s item=$p(itemlist,",",x)
 . . i item="I68",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I139=$i(I139),I140=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I140
 . . i item="I60",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I141=$i(I141),I142=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I142
 . . i item="I66",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I144=$i(I144),I145=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I145
 . . i item="I58",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I146=$i(I146),I147=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I147
 . . i item="I67",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I149=$i(I149),I150=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I150
 . . i item="I59",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I151=$i(I151),I152=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I152
 . . i item="I64",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I154=$i(I154),I155=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I155
 . . i item="I56",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I156=$i(I156),I157=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I157
 . . i item="I52",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I159=$i(I159),I160=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I160
 . . i item="I51",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I161=$i(I161),I162=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I162
 . . i item="I62",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I164=$i(I164),I165=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I165
 . . i item="I54",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I166=$i(I166),I167=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I167
 . . i item="I65",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I169=$i(I169),I170=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I170
 . . i item="I57",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I171=$i(I171),I172=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I172
 . . i item="I61",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I174=$i(I174),I175=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I175
 . . i item="I53",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I176=$i(I176),I177=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I177
 . . i item="I63",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I179=$i(I179),I180=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I180
 . . i item="I55",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I181=$i(I181),I182=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I182
 . . i item="I70",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I184=$i(I184),I185=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I185
 . . i item="I71",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I186=$i(I186),I187=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I187
 . . i item="I72",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I189=$i(I189),I190=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I190
 . . i item="I73",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I191=$i(I191),I192=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I192
 . . i item="I49",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I194=$i(I194),I195=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I195
 . . i item="I50",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I196=$i(I196),I197=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I197
 . . i item="I69",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I198=$i(I198),I199=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I199
 . . i item="I74",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I200=$i(I200),I201=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I201
 . . i item="I75",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I202=$i(I202),I203=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I203
 . . i item="I76",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I204=$i(I204),I205=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I205
 . . i item="I77",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I206=$i(I206),I207=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I207
 . . i item="I78",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I208=$i(I208),I209=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I209
 . . i item="I79",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I210=$i(I210),I211=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I211
 . . i item="I80",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I212=$i(I212),I213=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I213
 . . i item="I81",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I214=$i(I214),I215=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I215
 . . i item="I82",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I216=$i(I216),I217=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I217
 . . i item="I83",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I218=$i(I218),I219=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I219
 . . i item="I84",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I220=$i(I220),I221=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I221
 . . i item="I85",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I222=$i(I222),I223=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I223
 . . i item="I86",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I224=$i(I224),I225=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I225
 . . i item="I87",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I226=$i(I226),I227=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I227
 . . i item="I103",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I229=$i(I229)
 . . i item="I104",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I230=$i(I230),I231=I230		;I231=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I231
 . . i item="I105",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I232=$i(I232),I233=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I233
 . . i item="I106",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I234=$i(I234),I235=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I235
 . . i item="I107",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I236=$i(I236),I237=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I237
 . . i item="I108",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I238=$i(I238),I239=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I239
 . . i item="I109",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I240=$i(I240),I241=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I241
 . . i item="I110",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I242=$i(I242),I243=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I243
 . . i item="I111",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I244=$i(I244),I245=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I245
 . . i item="I112",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I246=$i(I246),I247=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I247
 . . i item="I113",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I248=$i(I248),I249=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I249
 . . i item="I114",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I251=$i(I251),I252=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I252
 . . i item="I117",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I254=$i(I254),I255=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I255
 . . i item="I118",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I256=$i(I256),I257=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I257
 . . i item="I120",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I258=$i(I258),I259=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I259
 . . i item="I121",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I260=$i(I260),I261=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I261
 . . i item="I119",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I263=$i(I263),I264=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I264
 . . i item="I122",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I265=$i(I265),I266=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I266
 . . i item="I123",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I267=$i(I267),I268=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I268
 . . i item="I125",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I269=$i(I269),I270=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I270
 . . i item="I124",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I272=$i(I272),I273=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I273
 . . i item="I126",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I274=$i(I274),I275=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I275
 . . i item="I127",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I276=$i(I276),I277=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I277
 . . i item="I129",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I278=$i(I278),I279=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I279
 . . i item="I130",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I280=$i(I280),I281=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I281
 . . i item="I128",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I283=$i(I283),I284=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I284
 . . i item="I131",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I285=$i(I285),I286=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I286
 . . i item="I132",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I287=$i(I287),I288=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I288
 . . i item="I133",$g(^zCacheTemp("VICHACCSummary",repid1,patid,item)) s I289=$i(I289),I290=$g(^zCacheTemp("VICHACCSummary",repid1,patid,item))+I290
 . ;s Total=Total+(I143+I148+I153+I158+I163+I168+I173+I178+I183+I188+I195+I197+I199+I201+I203+I205+I207+I209+I228+I250+I262+I271+I282+I291) 
 
 s I143=I140+I142
 s I148=I145+I147
 s I153=I150+I152
 s I158=I155+I157
 s I163=I160+I162
 s I168=I165+I167
 s I173=I170+I172
 s I178=I175+I177
 s I183=I180+I182
 s I188=I185+I187
 s I193=I190+I192
 s I228=I225+I227
 i I247>0 s I247=I247_" days"
 s I250=I241+I243+I245+I249
 s I262=I255+I257+I259+I261
 s I271=I266+I268+I270
 s I282=I275+I277+I279+I281
 s I291=I286+I288+I290
 s Total=I148+I153+I158+I163+I168+I173+I178+I183+I188+I195+I197+I199+I201+I203+I205+I207+I209+I228+I250+I262+I271+I282+I291 i $f(filepath,"/") s filename=$p(filepath,"/",$l(filepath,"/")-1)_".csv"
 i $f(filepath,"\") s filename=$p(filepath,"\",$l(filepath,"\")-1)_".csv"
 
 s filepath=filepath_"HACC Summary"_$e(filename,5,$l(filename))
 
 s file=##class(%File).%New(filepath)
 d file.Open("WSN")
 d file.WriteLine(",HACC EXTRACT SUMMARY REPORT")
 d file.WriteLine("4,AGENCY IDENTIFIER,"_I4)
 d file.WriteLine("5,DATA COLLECTION IDENTIFIER,"_I5)
 d file.WriteLine("6,TRANSMISSION NUMBER,"_I6)
 d file.WriteLine("8,NUMBER OF CLIENT RECORDS FOLLOWING,"_I8)
 d file.WriteLine("")
 d file.WriteLine(",HACC PROGRAM SERVICE DATA:,Number of Clients (by Service),Totals / Counts,Combined Totals")
 d file.WriteLine("68,ALLIED HEALTH CARE RECEIVED AT CENTRE  (hours),"_I139_","_I140_",Combined Hours Total")
 d file.WriteLine("60,ALLIED HEALTH CARE RECEIVED AT HOME - TOTAL TIME (Hours),"_I141_","_I142_","_I143)
 d file.WriteLine("")
 d file.WriteLine("66,AUDIOLOGY AT CENTRE (hours),"_I144_","_I145_",Combined Hours Total")
 d file.WriteLine("58,AUDIOLOGY AT HOME (hours),"_I146_","_I147_","_I148_"")
 d file.WriteLine("")
 d file.WriteLine("67,COUNSELLING AT CENTRE (hours),"_I149_","_I150_",Combined Hours Total")
 d file.WriteLine("59,COUNSELLING AT HOME (hours),"_I151_","_I152_","_I153)
 d file.WriteLine("")
 d file.WriteLine("64,DIETETICS AT CENTRE (hours),"_I154_","_I155_",Combined Hours Total")
 d file.WriteLine("56,DIETETICS AT HOME (hours),"_I156_","_I157_","_I158)
 d file.WriteLine("")
 d file.WriteLine("52,NURSING RECEIVED AT CENTRE  (hours),"_I159_","_I160_",Combined Hours Total")
 d file.WriteLine("51,NURSING RECEIVED AT HOME  (hours),"_I161_","_I162_","_I163)
 d file.WriteLine("")
 d file.WriteLine("62,OCCUPATIONAL THERAPY AT CENTRE (hours) ,"_I164_","_I165_",Combined Hours Total")
 d file.WriteLine("54,OCCUPATIONAL THERAPY AT HOME (hours),"_I166_","_I167_","_I168)
 d file.WriteLine("")
 d file.WriteLine("65,PHYSIOTHERAPY AT CENTRE (hours),"_I169_","_I170_",Combined Hours Total")
 d file.WriteLine("57,PHYSIOTHERAPY AT HOME (hours),"_I171_","_I172_","_I173)
 d file.WriteLine("")
 d file.WriteLine("61,PODIATRY AT CENTRE (hours),"_I174_","_I175_",Combined Hours Total")
 d file.WriteLine("53,PODIATRY AT HOME (hours),"_I176_","_I177_","_I178)
 d file.WriteLine("")
 d file.WriteLine("63,SPEECH PATHOLOGY AT CENTRE (hours),"_I179_","_I180_",Combined Hours Total")
 d file.WriteLine("55,SPEECH PATHOLOGY AT HOME (hours),"_I181_","_I182_","_I183)
 d file.WriteLine("")
 d file.WriteLine("70,"_$c(34)_"PLANNED ACTIVITY GROUP, CORE  (hours)"_$c(34)_","_I184_","_I185_",Combined Hours Total")
 d file.WriteLine("71,"_$c(34)_"PLANNED ACTIVITY GROUP, HIGH  (hours)"_$c(34)_","_I186_","_I187_","_I188)
 d file.WriteLine("")
 d file.WriteLine("72,MEALS RECEIVED AT HOME (no. of meals),"_I189_","_I190_",Combined Hours Total")
 d file.WriteLine("73,MEALS RECEIVED AT CENTRE (no. of meals),"_I191_","_I192_","_I193)
 d file.WriteLine("")
 d file.WriteLine("49,DOMESTIC ASSISTANCE (hours),"_I194_",,"_I195)
 d file.WriteLine("50,VOL. SOCIAL SUPPORT  (hours),"_I196_",,"_I197)
 d file.WriteLine("69,PERSONAL CARE  (hours),"_I198_",,"_I199)
 d file.WriteLine("")
 d file.WriteLine("74,RESPITE  (hours),"_I200_",,"_I201)
 d file.WriteLine("75,ASSESSMENT (hours),"_I202_",,"_I203)
 d file.WriteLine("76,CASE MANAGEMENT (hours),"_I204_",,"_I205)
 d file.WriteLine("77,CLIENT CARE COORDINATION  (hours),"_I206_",,"_I207)
 d file.WriteLine("78,PROPERTY MAINTENANCE  (hours),"_I208_",,"_I209)
 d file.WriteLine("")
 d file.WriteLine("79,PROVISION OF GOODS AND EQUIPMENT - Self Care Aids,"_I210_",,"_I211)
 d file.WriteLine("80,PROVISION OF GOODS AND EQUIPMENT - Supporting and Mobility Aids,"_I212_",,"_I213)
 d file.WriteLine("81,PROVISION OF GOODS AND EQUIPMENT - Communication Aids,"_I214_",,"_I215)
 d file.WriteLine("82,PROVISION OF GOODS AND EQUIPMENT - Aids for reading,"_I216_",,"_I217)
 d file.WriteLine("83,PROVISION OF GOODS AND EQUIPMENT - Medical Care Aids,"_I218_",,"_I219)
 d file.WriteLine("84,PROVISION OF GOODS AND EQUIPMENT - Car modifications,"_I220_",,"_I221)
 d file.WriteLine("85,PROVISION OF GOODS AND EQUIPMENT - Other goods/equipment ,"_I222_",,"_I223)
 d file.WriteLine("")
 d file.WriteLine("86,"_$c(34)_"COUNSELLING/SUPPORT, INFORMATION AND ADVOCACY - CARE RECIPIENT (hours)"_$c(34)_","_I224_","_I225)
 d file.WriteLine("87,"_$c(34)_"COUNSELLING/SUPPORT, INFORMATION AND ADVOCACY - CARER (hours)"_$c(34)_","_I226_","_I227_","_I228)
 d file.WriteLine("")
 d file.WriteLine(",HACC GRANT (Community Connections Program) SERVICE DATA:")
 d file.WriteLine("103,HRS Registered Client,"_I229_",,Total Count of Calls")
 d file.WriteLine("104,HRS Confirmation Call,"_I230_",,"_I231)
 d file.WriteLine("105,HRS Call-out in Time 1,"_I232_","_I233)
 d file.WriteLine("106,HRS Call-out in Time 2,"_I234_","_I235)
 d file.WriteLine("107,HRS Call-out in Time 3,"_I236_","_I237)
 d file.WriteLine("108,HRS Call-out in Time 4,"_I238_","_I239)
 d file.WriteLine("")
 d file.WriteLine("109,SCP Respite daytime in home,"_I240_","_I241)
 d file.WriteLine("110,SCP Respite overnight in home non-active,"_I242_","_I243)
 d file.WriteLine("111,SCP Respite overnight in home active,"_I244_","_I245)
 d file.WriteLine("112,SCP Respite residential,"_I246_","_I247_",Combined Hours Total")
 d file.WriteLine("113,SCP Counselling and support,"_I248_","_I249_","_I250)
 d file.WriteLine("114,SCP Goods and equipment cost (whole $),"_I251_",,"_I252)
 d file.WriteLine("")
 d file.WriteLine("117,CCP Assertive Outreach (hours),"_I254_","_I255)
 d file.WriteLine("118,CCP Care Coordination (hours),"_I256_","_I257)
 d file.WriteLine("120,CCP Housing Assistance (hours),"_I258_","_I259_",Combined Hours Total")
 d file.WriteLine("121,CCP Group Social Support (hours),"_I260_","_I261_","_I262)
 d file.WriteLine("119,CCP Flexible Care Funds (whole $),"_I263_",,"_I264)
 d file.WriteLine("")
 d file.WriteLine("122,HSAP Assertive Outreach (hours),"_I265_","_I266)
 d file.WriteLine("123,HSAP Care Coordination (hours),"_I267_","_I268_",Combined Hours Total")
 d file.WriteLine("125,HSAP Housing Assistance (hours),"_I269_","_I270_","_I271)
 d file.WriteLine("124,HSAP Flexible Care Funds (whole $),"_I272_",,"_I273)
 d file.WriteLine("")
 d file.WriteLine("126,OPHR Assertive Outreach (hours),"_I274_","_I275)
 d file.WriteLine("127,OPHR Care Coordination (hours),"_I276_","_I277)
 d file.WriteLine("129,OPHR Housing Assistance (hours),"_I278_","_I279_",Combined Hours Total")
 d file.WriteLine("130,OPHR Group Social Support (hours),"_I280_","_I281_","_I282)
 d file.WriteLine("128,OPHR Flexible Care Funds (whole $),"_I283_",,"_I284)
 d file.WriteLine("")
 d file.WriteLine("131,SRS Care Coordination (hours),"_I285_","_I286)
 d file.WriteLine("132,SRS Housing Assistance (hours),"_I287_","_I288_",Combined Hours Total")
 d file.WriteLine("133,SRS Group Social Support (hours),"_I289_","_I290_","_I291)
 d file.WriteLine("")
 d file.WriteLine(",Total Hours,,,"_Total)
 d file.WriteLine(",Client UR Details List")
 d file.WriteLine(",List of Client Names,List of Client UR Numbers,List of Client SLK's")
 s patid=0 f  s patid=$o(^zCacheTemp("VICHACCSummary",repid1,"Clients",patid)) q:patid=""  d
 . d file.WriteLine(","_$c(34)_$p($g(^zCacheTemp("VICHACCSummary",repid1,"Clients",patid)),"^",1)_$c(34)_","_$p($g(^zCacheTemp("VICHACCSummary",repid1,"Clients",patid)),"^",2)_","_$p($g(^zCacheTemp("VICHACCSummary",repid1,"Clients",patid)),"^",3))
 d file.Close()
 
 k ^zCacheTemp("VICHACCSummary",repid1)
 q 1
]]></Implementation>
</Method>

<Method name="PHMPRSummary">
<ClassMethod>1</ClassMethod>
<FormalSpec>filepath:%Library.String,date:%Library.String,time:%Library.String</FormalSpec>
<Implementation><![CDATA[
 n S1,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,S24,S25,S26,S27,S28,S29,S30,S31,S32,S33,S34,S35,S36,S37,S38,S39,S40,S41,S42,S43,S44,S45,S46,S47,S48,S49,S50,S51,S52,S53,S54,S55,S56,S57,S58,S59,S60,S61,S62,S63,S64,S65,S66,S67,S68,S69,S70,S71,S72,S73,S74,S75,S76,S77,S78,S79,S80,S81,S82,S83,S84,S85,S86,S87,S88,S89,S90,S91,S92,S93,S94,S95,S96,S97,S98,S99
 n S100,S101,S102,S103,S104,S105,S106,S107,S108,S109,S110,S111,S112,S113,S114,S115,S116,S117,S118,S119,S120,S121,S122,S123,S124,S125,S126,S127,S128,S129,S130,S131,S132,S133,S134,S135,S136,S137,S138,S139,S140,S141,S142,S143,S144,S145,S146,S147,S148,S149,S150,S151,S152,S153,S154,S155,S156,S157,S158,S159,S160,S161,S162,S163,S164,S165,S166,S167,S168,S169,S170,S171,S172,S173,S174,S175,S176,S177,S178,S179,S180,S181,S182,S183,S184,S185,S186,S187,S188,S189,S190,S191,S192,S193,S194,S195,S196,S197,S198,S199
 n S200,S201,S202,S203,S204,S205,S206,S207,S208,S209,S210,S211,S212,S213,S214,S215,S216,S217,S218,S219,S220,S221,S222,S223,S224,S225,S226,S227,S228,S229,S230,S231,S232,S233,S234,S235,S236,S237,S238,S239,S240,S241,S242,S243,S244,S245,S246,S247,S248,S249,S250,S251,S252,S253,S254,S255,S256,S257,S258,S259,S260,S261,S262,S263,S264,S265,S266,S267,S268,S269,S270,S271,S272,S273,S274,S275,S276,S277,S278,S279,S280,S281,S282,S283,S284,S285,S286,S287,S288,S289,S290,S291,S292,S293,S294,S295,S296,S297,S298,S299
 n S300,S301,S302,S303,S304,S305,S306,S307,S308,S309,S310,S311,S312,S313,S314,S315,S316,S317,S318,S319,S320,S321,S322,S323,S324,S325,S326,S327,S328,S329,S330,S331,S332,S333,S334,S335,S336,S337,S338,S339,S340,S341,S342,S343,S344,S345,S346,S347,S348,S349,S350,S351,S352,S353,S354,S355,S356,S357,S358,S359,S360,S361,S362,S363,S364,S365,S366,S367,S368,S369,S370,S371,S372,S373,S374,S375,S376,S377,S378,S379,S380,S381,S382,S383,S384,S385,S386,S387,S388,S389,S390,S391,S392,S393,S394,S395,S396,S397,S398,S399
 n S400,S401,S402,S403,S404,S405,S406,S407,S408,S409,S410,S411,S412,S413,S414,S415,S416,S417,S418,S419,S420,S421,S422,S423,S424,S425,S426,S427,S428,S429,S430,S431,S432,S433,S434,S435,S436,S437,S438,S439,S440,S441,S442,S443,S444,S445,S446,S447,S448,S449,S450,S451,S452,S453,S454,S455,S456,S457,S458,S459,S460,S461,S462,S463,S464,S465,S466,S467,S468,S469,S470,S471,S472,S473,S474,S475,S476,S477,S478,S479,S480,S481,S482,S483,S484,S485,S486,S487,S488,S489,S490,S491,S492,S493,S494,S495,S496,S497,S498,S499
 n S500,S501,S502,S503,S504,S505,S506,S507,S508,S509,S510,S511,S512,S513,S514,S515,S516,S517,S518,S519,S520,S521,S522,S523,S524,S525,S530,S531,S532,S533,S534,S535,S536,S540,S541,S542,S543,S544,S545,S546,S550,S551,S552,S553,S554,S555,S556,S630,S631,S632,S633,S634,S635,S636,S640,S641,S642,S643,S644,S645,S646,S650,S651,S652,S653,S654,S655,S656,S730,S731,S732,S733,S734,S735,S736,S740,S741,S742,S743,S744,S745,S746,S750,S751,S752,S753,S754,S755,S756,S830,S831,S832,S833,S834,S835,S836,S840,S841,S842,S843
 n S844,S845,S846,S850,S851,S852,S853,S854,S855,S856,S930,S931,S932,S933,S934,S935,S936,S940,S941,S942,S943,S944,S945,S946,S950,S951,S952,S953,S954,S955,S956,S1030,S1031,S1032,S1033,S1034,S1035,S1036,S1040,S1041,S1042,S1043,S1044,S1045,S1046,S1050,S1051,S1052,S1053,S1054,S1055,S1056,S1130,S1131,S1132,S1133,S1134,S1135,S1136,S1140,S1141,S1142,S1143,S1144,S1145,S1146,S1150,S1151,S1152,S1153,S1154,S1155,S1156,S1230,S1231,S1232,S1233,S1234,S1235,S1236,S1240,S1241,S1242,S1243,S1244,S1245,S1246,S1250
 n S1251,S1252,S1253,S1254,S1255,S1256,S1330,S1331,S1332,S1333,S1334,S1335,S1336,S1340,S1341,S1342,S1343,S1344,S1345,S1346,S1350,S1351,S1352,S1353,S1354,S1355,S1356,S1430,S1431,S1432,S1433,S1434,S1435,S1436,S1440,S1441,S1442,S1443,S1444,S1445,S1446,S1450,S1451,S1452,S1453,S1454,S1455,S1456,S1510,S1511,S1512,S1513,S1514,S1515,S1516,S1520,S1521,S1522,S1563,S1564,S1565,S1566,S1570,S1571,S1572,S1573,S1574,S1575,S1576,S1580,S1581,S1582,S1583,S1584,S1585,S1586,S1590,S1591,S1592,S1593,S1594,S1595,S1596
 n S1610,S1611,S1612,S1613,S1614,S1615,S1616,S1620,S1621,S1622,S1623,S1624,S1625,S1626,S1630,S1631,S1632,S1633,S1634,S1635,S1636,S1530,S1531,S1532,S1533,S1534,S1535,S1536,S1540,S1541,S1542,S1543,S1544,S1545,S1546,S1550,S1551,S1552,S1553,S1554,S1555,S1556,S1640,S1641,S1642,S1643,S1644,S1645,S1646,S1648,S1649
 n S1710,S1711,S1712,S1713,S1714,S1715,S1716,S1720,S1721,S1722,S1763,S1764,S1765,S1766,S1770,S1771,S1772,S1773,S1774,S1775,S1776,S1780,S1781,S1782,S1783,S1784,S1785,S1786,S1790,S1791,S1792,S1793,S1794,S1795,S1796,S1810,S1811,S1812,S1813,S1814,S1815,S1816,S1820,S1821,S1822,S1823,S1824,S1825,S1826,S1830,S1831,S1832,S1833,S1834,S1835,S1836,S1730,S1731,S1732,S1733,S1734,S1735,S1736,S1740,S1741,S1742,S1743,S1744,S1745,S1746,S1750,S1751,S1752,S1753,S1754,S1755,S1756,S1840,S1841,S1842,S1843,S1844,S1845,S1846,S1848,S1849
 n S1910,S1911,S1912,S1913,S1914,S1915,S1916,S1920,S1921,S1922,S1963,S1964,S1965,S1966,S1970,S1971,S1972,S1973,S1974,S1975,S1976,S1980,S1981,S1982,S1983,S1984,S1985,S1986,S1990,S1991,S1992,S1993,S1994,S1995,S1996,S2010,S2011,S2012,S2013,S2014,S2015,S2016,S2020,S2021,S2022,S2023,S2024,S2025,S2026,S2030,S2031,S2032,S2033,S2034,S2035,S2036,S1930,S1931,S1932,S1933,S1934,S1935,S1936,S1940,S1941,S1942,S1943,S1944,S1945,S1946,S1950,S1951,S1952,S1953,S1954,S1955,S1956,S2040,S2041,S2042,S2043,S2044,S2045,S2046,S2048,S2049
 
 s (S1,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,S24,S25,S26,S27,S28,S29,S30,S31,S32,S33,S34,S35,S36,S37,S38,S39,S40,S41,S42,S43,S44,S45,S46,S47,S48,S49,S50,S51,S52,S53,S54,S55,S56,S57,S58,S59,S60,S61,S62,S63,S64,S65,S66,S67,S68,S69,S70,S71,S72,S73,S74,S75,S76,S77,S78,S79,S80,S81,S82,S83,S84,S85,S86,S87,S88,S89,S90,S91,S92,S93,S94,S95,S96,S97,S98,S99)=0
 s (S100,S101,S102,S103,S104,S105,S106,S107,S108,S109,S110,S111,S112,S113,S114,S115,S116,S117,S118,S119,S120,S121,S122,S123,S124,S125,S126,S127,S128,S129,S130,S131,S132,S133,S134,S135,S136,S137,S138,S139,S140,S141,S142,S143,S144,S145,S146,S147,S148,S149,S150,S151,S152,S153,S154,S155,S156,S157,S158,S159,S160,S161,S162,S163,S164,S165,S166,S167,S168,S169,S170,S171,S172,S173,S174,S175,S176,S177,S178,S179,S180,S181,S182,S183,S184,S185,S186,S187,S188,S189,S190,S191,S192,S193,S194,S195,S196,S197,S198,S199)=0
 s (S200,S201,S202,S203,S204,S205,S206,S207,S208,S209,S210,S211,S212,S213,S214,S215,S216,S217,S218,S219,S220,S221,S222,S223,S224,S225,S226,S227,S228,S229,S230,S231,S232,S233,S234,S235,S236,S237,S238,S239,S240,S241,S242,S243,S244,S245,S246,S247,S248,S249,S250,S251,S252,S253,S254,S255,S256,S257,S258,S259,S260,S261,S262,S263,S264,S265,S266,S267,S268,S269,S270,S271,S272,S273,S274,S275,S276,S277,S278,S279,S280,S281,S282,S283,S284,S285,S286,S287,S288,S289,S290,S291,S292,S293,S294,S295,S296,S297,S298,S299)=0
 s (S300,S301,S302,S303,S304,S305,S306,S307,S308,S309,S310,S311,S312,S313,S314,S315,S316,S317,S318,S319,S320,S321,S322,S323,S324,S325,S326,S327,S328,S329,S330,S331,S332,S333,S334,S335,S336,S337,S338,S339,S340,S341,S342,S343,S344,S345,S346,S347,S348,S349,S350,S351,S352,S353,S354,S355,S356,S357,S358,S359,S360,S361,S362,S363,S364,S365,S366,S367,S368,S369,S370,S371,S372,S373,S374,S375,S376,S377,S378,S379,S380,S381,S382,S383,S384,S385,S386,S387,S388,S389,S390,S391,S392,S393,S394,S395,S396,S397,S398,S399)=0
 s (S400,S401,S402,S403,S404,S405,S406,S407,S408,S409,S410,S411,S412,S413,S414,S415,S416,S417,S418,S419,S420,S421,S422,S423,S424,S425,S426,S427,S428,S429,S430,S431,S432,S433,S434,S435,S436,S437,S438,S439,S440,S441,S442,S443,S444,S445,S446,S447,S448,S449,S450,S451,S452,S453,S454,S455,S456,S457,S458,S459,S460,S461,S462,S463,S464,S465,S466,S467,S468,S469,S470,S471,S472,S473,S474,S475,S476,S477,S478,S479,S480,S481,S482,S483,S484,S485,S486,S487,S488,S489,S490,S491,S492,S493,S494,S495,S496,S497,S498,S499)=0
 s (S500,S501,S502,S503,S504,S505,S506,S507,S508,S509,S510,S511,S512,S513,S514,S515,S516,S517,S518,S519,S520,S521,S522,S523,S524,S525,S530,S531,S532,S533,S534,S535,S536,S540,S541,S542,S543,S544,S545,S546,S550,S551,S552,S553,S554,S555,S556,S630,S631,S632,S633,S634,S635,S636,S640,S641,S642,S643,S644,S645,S646,S650,S651,S652,S653,S654,S655,S656,S730,S731,S732,S733,S734,S735,S736,S740,S741,S742,S743,S744,S745,S746,S750,S751,S752,S753,S754,S755,S756,S830,S831,S832,S833,S834,S835,S836,S840,S841,S842,S843)=0
 s (S844,S845,S846,S850,S851,S852,S853,S854,S855,S856,S930,S931,S932,S933,S934,S935,S936,S940,S941,S942,S943,S944,S945,S946,S950,S951,S952,S953,S954,S955,S956,S1030,S1031,S1032,S1033,S1034,S1035,S1036,S1040,S1041,S1042,S1043,S1044,S1045,S1046,S1050,S1051,S1052,S1053,S1054,S1055,S1056,S1130,S1131,S1132,S1133,S1134,S1135,S1136,S1140,S1141,S1142,S1143,S1144,S1145,S1146,S1150,S1151,S1152,S1153,S1154,S1155,S1156,S1230,S1231,S1232,S1233,S1234,S1235,S1236,S1240,S1241,S1242,S1243,S1244,S1245,S1246,S1250)=0
 s (S1251,S1252,S1253,S1254,S1255,S1256,S1330,S1331,S1332,S1333,S1334,S1335,S1336,S1340,S1341,S1342,S1343,S1344,S1345,S1346,S1350,S1351,S1352,S1353,S1354,S1355,S1356,S1430,S1431,S1432,S1433,S1434,S1435,S1436,S1440,S1441,S1442,S1443,S1444,S1445,S1446,S1450,S1451,S1452,S1453,S1454,S1455,S1456,S1510,S1511,S1512,S1513,S1514,S1515,S1516,S1520,S1521,S1522,S1563,S1564,S1565,S1566,S1570,S1571,S1572,S1573,S1574,S1575,S1576,S1580,S1581,S1582,S1583,S1584,S1585,S1586,S1590,S1591,S1592,S1593,S1594,S1595,S1596)=0
 s (S1610,S1611,S1612,S1613,S1614,S1615,S1616,S1620,S1621,S1622,S1623,S1624,S1625,S1626,S1630,S1631,S1632,S1633,S1634,S1635,S1636,S1530,S1531,S1532,S1533,S1534,S1535,S1536,S1540,S1541,S1542,S1543,S1544,S1545,S1546,S1550,S1551,S1552,S1553,S1554,S1555,S1556,S1640,S1641,S1642,S1643,S1644,S1645,S1646,S1648,S1649)=0
 s (S1710,S1711,S1712,S1713,S1714,S1715,S1716,S1720,S1721,S1722,S1763,S1764,S1765,S1766,S1770,S1771,S1772,S1773,S1774,S1775,S1776,S1780,S1781,S1782,S1783,S1784,S1785,S1786,S1790,S1791,S1792,S1793,S1794,S1795,S1796,S1810,S1811,S1812,S1813,S1814,S1815,S1816,S1820,S1821,S1822,S1823,S1824,S1825,S1826,S1830,S1831,S1832,S1833,S1834,S1835,S1836,S1730,S1731,S1732,S1733,S1734,S1735,S1736,S1740,S1741,S1742,S1743,S1744,S1745,S1746,S1750,S1751,S1752,S1753,S1754,S1755,S1756,S1840,S1841,S1842,S1843,S1844,S1845,S1846,S1848,S1849)=0
 s (S1910,S1911,S1912,S1913,S1914,S1915,S1916,S1920,S1921,S1922,S1963,S1964,S1965,S1966,S1970,S1971,S1972,S1973,S1974,S1975,S1976,S1980,S1981,S1982,S1983,S1984,S1985,S1986,S1990,S1991,S1992,S1993,S1994,S1995,S1996,S2010,S2011,S2012,S2013,S2014,S2015,S2016,S2020,S2021,S2022,S2023,S2024,S2025,S2026,S2030,S2031,S2032,S2033,S2034,S2035,S2036,S1930,S1931,S1932,S1933,S1934,S1935,S1936,S1940,S1941,S1942,S1943,S1944,S1945,S1946,S1950,S1951,S1952,S1953,S1954,S1955,S1956,S2040,S2041,S2042,S2043,S2044,S2045,S2046,S2048,S2049)=0
 
 n S117A,S118A,S119A,S120A,S121A,S122A,S123A
 s (S117A,S118A,S119A,S120A,S121A,S122A,S123A)=0
 
 n S525,S526
 s (S525,S526)=0
 
 n filename,fundingcode,activity
 s (filename,fundingcode,activity)=""
 
 s repid1=$i(^zCacheTemp("VICPHMPRSummary"))
 k ^zCacheTemp("VICPHMPRSummary",repid1)
 
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",2,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",5,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",4,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",7,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",9,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",1,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",2,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",2,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",2,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",2,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",2,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",2,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",4,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",4,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",4,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",4,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",4,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",4,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",5,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",5,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",5,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",5,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",5,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",5,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",7,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",7,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",7,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",7,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",7,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",9,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",9,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",9,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",9,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",9,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",11,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",21,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",12,15)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",18,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",19,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",20,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",22,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,1)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,2)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,3)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,4)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,5)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,6)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,7)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,8)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,41)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,43)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,44)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",23,45)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 
 n transmissionno
 s transmissionno=0
 i $f(filepath,"\") s transmissionno=+$e($p(filepath,"\",$l(filepath,"\")-1),7,8)
 i $f(filepath,"/") s transmissionno=+$e($p(filepath,"/",$l(filepath,"/")-1),7,8)
 i $l(transmissionno)=1 s transmissionno="0"_transmissionno
 
 s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","PHMPR",date,time,id)) q:id=""  d
 . q:$p($g(^Custom.ExtractSummaries(id)),"^",15)'=transmissionno
 . i ((",CLIENT,EVENT,ANONYMOUS,")[(","_$p($g(^Custom.ExtractSummaries(id)),"^",5)_",")) d
 . . s S1=$p($g(^Custom.ExtractSummaries(id)),"^",13)
 . . s S2=$p($g(^Custom.ExtractSummaries(id)),"^",14)
 . . s S3=$p($g(^Custom.ExtractSummaries(id)),"^",15)
 . . s S4=$p($g(^Custom.ExtractSummaries(id)),"^",17)
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",27)'="" s ^zCacheTemp("VICPHMPRSummary",repid1,"S5",$p($g(^Custom.ExtractSummaries(id)),"^",27))=""
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",28)'="" s ^zCacheTemp("VICPHMPRSummary",repid1,"S6",$p($g(^Custom.ExtractSummaries(id)),"^",28))=""
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",33)'="" s ^zCacheTemp("VICPHMPRSummary",repid1,"S8",$p($g(^Custom.ExtractSummaries(id)),"^",33))=""
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",31)="1" s S9=$i(S9)
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",31)="2" s S10=$i(S10)
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",54)'="" s S11=S11+$p($g(^Custom.ExtractSummaries(id)),"^",54)
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",32)="C" s S12=$i(S12)
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",32)="R" s S13=$i(S13)
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",32)="O" s S14=$i(S14)
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",29)'="" s ^zCacheTemp("VICPHMPRSummary",repid1,"S15",$p($g(^Custom.ExtractSummaries(id)),"^",29))=""
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",30)'="" s ^zCacheTemp("VICPHMPRSummary",repid1,"S16",$p($g(^Custom.ExtractSummaries(id)),"^",30))=""
 . . ;
 . . s fundingcode=$p($g(^Custom.ExtractSummaries(id)),"^",27)
 . . s activity=$p($g(^Custom.ExtractSummaries(id)),"^",28)
 . . ;
 . . s S525=S525+$p($g(^Custom.ExtractSummaries(id)),"^",50)+$p($g(^Custom.ExtractSummaries(id)),"^",51)+$p($g(^Custom.ExtractSummaries(id)),"^",52)+$p($g(^Custom.ExtractSummaries(id)),"^",53)
 . . s S526=S526+$p($g(^Custom.ExtractSummaries(id)),"^",49)
 . . i $g(fundingcode)'="",$g(activity)'="" d
 . . . i '$d(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)) s ^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)=0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0_"^"_0
 . . . ;
 . . . s $p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",1)=$p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",1)+1
 . . . s $p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",2)=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)+$p($g(^Custom.ExtractSummaries(id)),"^",50)
 . . . s $p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",3)=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)+$p($g(^Custom.ExtractSummaries(id)),"^",51)
 . . . s $p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",4)=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)+$p($g(^Custom.ExtractSummaries(id)),"^",52)
 . . . s $p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",5)=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)+$p($g(^Custom.ExtractSummaries(id)),"^",53)
 . . . s $p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",6)=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)+$p($g(^Custom.ExtractSummaries(id)),"^",49)
 . . . s $p(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity),"^",7)=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)+$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)+$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)+$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 
 s fundingcode=1,activity=15
 s S17=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S18=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S19=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S20=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S21=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S22=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S23=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=2
 s S24=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S25=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S26=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S27=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S28=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S29=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S30=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=5
 s S31=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S32=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S33=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S34=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S35=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S36=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S37=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=4
 s S38=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S39=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S40=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S41=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S42=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S43=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S44=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=7
 s S45=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S46=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S47=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S48=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S49=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S50=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S51=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=9
 s S52=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S53=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S54=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S55=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S56=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S57=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S58=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=18
 s S59=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S60=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S61=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S62=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S63=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S64=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S65=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=19
 s S66=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S67=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S68=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S69=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S70=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S71=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S72=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s fundingcode=20
 s S73=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S74=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S75=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S76=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S77=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S78=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S79=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S80=S22+S29+S36+S43+S50+S57+S64+S71+S78
 s S81=S23+S30+S37+S44+S51+S58+S65+S72+S79
 
 s fundingcode=1,activity=1
 s S82=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S83=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S84=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S85=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S86=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S87=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S88=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S89=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S90=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S91=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S92=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S93=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S94=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S95=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S96=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S97=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S98=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S99=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S100=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S101=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S102=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S103=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S104=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S105=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S106=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S107=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S108=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S109=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S110=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S111=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S112=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S113=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S114=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S115=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S116=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S117=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S118=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S119=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S120=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S121=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S122=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S123=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S117A=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S118A=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S119A=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S120A=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S121A=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S122A=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S123A=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S124=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S125=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S126=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S127=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S128=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S129=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S130=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S530=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S531=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S532=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S533=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S534=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S535=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S536=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S540=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S541=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S542=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S543=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S544=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S545=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S546=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S550=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S551=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S552=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S553=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S554=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S555=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S556=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S131=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S132=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S133=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S134=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S135=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S136=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S137=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S138=S87+S94+S101+S108+S115+S122+S122A+S129+S535+S545+S555+S136
 s S139=S88+S95+S102+S109+S116+S123+S123A+S130+S536+S546+S556+S137
 
 s fundingcode=2,activity=8
 s S141=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S142=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S143=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S144=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S145=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S146=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S147=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S148=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S149=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S150=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S151=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S152=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S153=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S154=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S630=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S631=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S632=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S633=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S634=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S635=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S636=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S640=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S641=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S642=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S643=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S644=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S645=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S646=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S650=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S651=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S652=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S653=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S654=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S655=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S656=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S155=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S156=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S157=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S158=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S159=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S160=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S161=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S162=S146+S153+S635+S645+S655+S160
 s S163=S147+S154+S636+S646+S656+S161

 s fundingcode=4,activity=43
 s S164=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S165=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S166=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S167=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S168=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S169=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S170=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S171=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S172=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S173=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S174=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S175=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S176=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S177=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S178=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S179=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S180=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S181=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S182=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S183=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S184=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S185=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S186=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S187=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S188=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S189=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S190=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S191=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S730=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S731=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S732=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S733=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S734=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S735=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S736=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S192=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S193=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S194=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S195=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S196=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S197=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S198=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S199=S169+S176+S183+S190+S735+S197
 s S200=S170+S177+S184+S191++S736+S198

 s fundingcode=5,activity=8
 s S201=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S202=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S203=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S204=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S205=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S206=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S207=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S208=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S209=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S210=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S211=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S212=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S213=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S214=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S830=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S831=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S832=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S833=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S834=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S835=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S836=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S840=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S841=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S842=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S843=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S844=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S845=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S846=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S850=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S851=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S852=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S853=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S854=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S855=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S856=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S215=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S216=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S217=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S218=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S219=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S220=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S221=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S222=S206+S213+S835+S845+S855+S220
 s S223=S207+S214+S836+S846+S856+S221

 s fundingcode=7,activity=8
 s S224=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S225=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S226=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S227=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S228=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S229=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S230=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S930=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S931=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S932=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S933=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S934=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S935=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S936=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S940=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S941=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S942=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S943=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S944=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S945=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S946=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S950=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S951=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S952=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S953=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S954=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S955=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S956=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S231=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S232=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S233=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S234=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S235=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S236=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S237=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S238=S229+S935+S945+S955+S236
 s S239=S230+S936+S946+S956+S237

 s fundingcode=9,activity=8
 s S240=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S241=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S242=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S243=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S244=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S245=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S246=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1030=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1031=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1032=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1033=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1034=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1035=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1036=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1040=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1041=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1042=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1043=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1044=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1045=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1046=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1050=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1051=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1052=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1053=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1054=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1055=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1056=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S247=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S248=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S249=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S250=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S251=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S252=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S253=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S254=S245+S1035+S1045+S1055+S252
 s S255=S246+S1036+S1046+S1056+S253

 s fundingcode=21,activity=1
 s S1510=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1511=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1512=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1513=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1514=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1515=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1516=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S1520=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1521=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1522=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1523=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1524=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1525=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1526=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S1570=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1571=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1572=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1573=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1574=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1575=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1576=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S1580=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1581=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1582=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1583=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1584=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1585=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1586=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S1590=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1591=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1592=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1593=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1594=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1595=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1596=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S1610=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1611=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1612=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1613=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1614=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1615=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1616=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S1620=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1621=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1622=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1623=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1624=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1625=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1626=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S1630=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1631=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1632=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1633=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1634=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1635=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1636=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1530=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1531=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1532=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1533=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1534=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1535=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1536=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1540=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1541=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1542=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1543=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1544=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1545=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1546=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1550=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1551=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1552=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1553=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1554=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1555=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1556=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S1640=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1641=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1642=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1643=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1644=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1645=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1646=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S1648=S1515+S1565+S1575+S1585+S1595+S1615+S1625+S1635+S1535+S1545+S1555+S1645
 s S1649=S1516+S1566+S1576+S1586+S1596+S1616+S1626+S1636+S1536+S1546+S1556+S1646

 s fundingcode=12,activity=1
 s S256=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S257=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S258=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S259=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S260=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S261=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S262=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S263=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S264=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S265=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S266=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S267=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S268=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S269=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S270=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S271=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S272=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S273=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S274=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S275=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S276=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S277=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S278=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S279=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S280=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S281=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S282=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S283=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S284=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S285=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S286=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S287=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S288=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S289=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S290=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S291=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S292=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S293=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S294=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S295=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S296=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S297=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S298=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S299=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S300=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S301=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S302=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S303=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S304=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S305=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S306=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S307=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S308=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S309=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S310=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S311=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1130=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1131=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1132=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1133=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1134=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1135=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1136=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1140=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1141=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1142=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1143=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1144=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1145=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1146=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1150=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1151=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1152=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1153=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1154=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1155=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1156=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S312=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S313=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S314=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S315=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S316=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S317=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S318=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=15
 s S319=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S320=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S321=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S322=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S323=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S324=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S325=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S326=S261+S268+S275+S282+S289+S296+S303+S310+S1135+S1145+S1155+S317+S324
 s S327=S262+S269+S276+S283+S290+S297+S304+S311+S1136+S1146+S1156+S318+S325

 s fundingcode=18,activity=1
 s S328=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S329=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S330=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S331=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S332=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S333=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S334=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S335=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S336=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S337=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S338=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S339=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S340=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S341=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S342=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S343=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S344=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S345=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S346=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S347=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S348=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S349=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S350=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S351=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S352=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S353=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S354=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S355=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S356=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S357=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S358=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S359=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S360=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S361=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S362=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S363=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S364=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S365=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S366=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S367=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S368=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S369=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S370=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S371=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S372=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S373=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S374=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S375=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S376=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S377=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S378=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S379=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S380=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S381=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S382=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S383=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1230=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1231=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1232=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1233=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1234=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1235=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1236=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1240=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1241=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1242=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1243=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1244=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1245=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1246=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1250=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1251=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1252=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1253=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1254=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1255=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1256=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S384=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S385=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S386=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S387=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S388=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S389=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S390=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S391=S333+S340+S347+S354+S361+S368+S375+S382+S1235+S1245+S1255+S389
 s S392=S334+S341+S348+S355+S362+S369+S376+S383+S1236+S1246+S1256+S390

 s fundingcode=19,activity=1
 s S393=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S394=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S395=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S396=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S397=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S398=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S399=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S400=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S401=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S402=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S403=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S404=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S405=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S406=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S407=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S408=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S409=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S410=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S411=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S412=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S413=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S414=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S415=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S416=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S417=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S418=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S419=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S420=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S421=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S422=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S423=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S424=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S425=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S426=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S427=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S428=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S429=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S430=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S431=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S432=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S433=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S434=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S435=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S436=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S437=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S438=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S439=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S440=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S441=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S442=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S443=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S444=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S445=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S446=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S447=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S448=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1330=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1331=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1332=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1333=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1334=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1335=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1336=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1340=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1341=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1342=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1343=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1344=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1345=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1346=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1350=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1351=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1352=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1353=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1354=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1355=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1356=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S449=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S450=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S451=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S452=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S453=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S454=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S455=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S456=S398+S405+S412+S419+S426+S433+S440+S447+S1335+S1345+S1355+S454 
 s S457=S399+S406+S413+S420+S427+S434+S441+S448+S1336+S1346+S1356+S455
 
 s fundingcode=20,activity=1
 s S458=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S459=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S460=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S461=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S462=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S463=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S464=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S465=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S466=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S467=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S468=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S469=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S470=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S471=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S472=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S473=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S474=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S475=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S476=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S477=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S478=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S479=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S480=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S481=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S482=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S483=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S484=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S485=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S486=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S487=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S488=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S489=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S490=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S491=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S492=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S493=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S494=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S495=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S496=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S497=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S498=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S499=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S500=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S501=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S502=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S503=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S504=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S505=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S506=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S507=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S508=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S509=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S510=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S511=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S512=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S513=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1430=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1431=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1432=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1433=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1434=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1435=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1436=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1440=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1441=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1442=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1443=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1444=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1445=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1446=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1450=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1451=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1452=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1453=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1454=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1455=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1456=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S514=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S515=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S516=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S517=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S518=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S519=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S520=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S521=S463+S470+S477+S484+S491+S498+S505+S512+S1435+S1445+S1455+S519
 s S522=S464+S471+S478+S485+S492+S499+S506+S513+S1436+S1446+S1456+S520
 
 s fundingcode=22,activity=1
 s S1710=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1711=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1712=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1713=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1714=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1715=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1716=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S1720=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1721=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1722=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1763=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1764=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1765=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1766=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S1770=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1771=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1772=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1773=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1774=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1775=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1776=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S1780=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1781=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1782=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1783=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1784=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1785=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1786=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S1790=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1791=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1792=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1793=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1794=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1795=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1796=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S1810=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1811=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1812=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1813=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1814=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1815=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1816=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S1820=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1821=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1822=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1823=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1824=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1825=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1826=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S1830=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1831=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1832=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1833=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1834=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1835=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1836=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1730=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1731=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1732=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1733=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1734=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1735=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1736=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1740=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1741=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1742=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1743=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1744=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1745=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1746=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1750=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1751=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1752=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1753=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1754=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1755=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1756=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S1840=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1841=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1842=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1843=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1844=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1845=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1846=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S1848=S1715+S1765+S1775+S1785+S1795+S1815+S1825+S1835+S1735+S1745+S1755+S1845
 s S1849=S1716+S1766+S1776+S1786+S1796+S1816+S1826+S1836+S1736+S1746+S1756+S1846
 
 s fundingcode=23,activity=1
 s S1910=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1911=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1912=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1913=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1914=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1915=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1916=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=2
 s S1920=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1921=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1922=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1963=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1964=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1965=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1966=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=3
 s S1970=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1971=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1972=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1973=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1974=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1975=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1976=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=4
 s S1980=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1981=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1982=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1983=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1984=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1985=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1986=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=5
 s S1990=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1991=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1992=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1993=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1994=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1995=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1996=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=6
 s S2010=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S2011=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S2012=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S2013=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S2014=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S2015=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S2016=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=8
 s S2020=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S2021=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S2022=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S2023=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S2024=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S2025=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S2026=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=7
 s S2030=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S2031=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S2032=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S2033=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S2034=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S2035=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S2036=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=41
 s S1930=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1931=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1932=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1933=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1934=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1935=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1936=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=43
 s S1940=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1941=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1942=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1943=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1944=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1945=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1946=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=44
 s S1950=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S1951=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S1952=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S1953=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S1954=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S1955=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S1956=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s activity=45
 s S2040=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",1)
 s S2041=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",2)
 s S2042=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",3)
 s S2043=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",4)
 s S2044=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",5)
 s S2045=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",7)
 s S2046=$p($g(^zCacheTemp("VICPHMPRSummary",repid1,"Funding",fundingcode,activity)),"^",6)
 s S2048=S1915+S1965+S1975+S1985+S1995+S2015+S2025+S2035+S1935+S1945+S1955+S2045
 s S2049=S1916+S1966+S1976+S1986+S1996+S2016+S2026+S2036+S1936+S1946+S1956+S2046
 
 s S523=S80+S138+S162+S199+S222+S238+S254+S326+S391+S456+S521+S1648+S1848+S2048
 s S524=S81+S139+S163+S200+S223+S239+S255+S327+S392+S457+S522+S1649+S1849+S2049
 
 i $f(filepath,"/") s filename=$p(filepath,"/",$l(filepath,"/")-1)_".csv"
 i $f(filepath,"\") s filename=$p(filepath,"\",$l(filepath,"\")-1)_".csv"
 
 s filepath=filepath_"PHMPR Summary"_$e(filename,6,$l(filename))
 
 s file=##class(%File).%New(filepath)
 d file.Open("WSN")
 d file.WriteLine(",,,Community Health PH MPR - EXTRACT SUMMARY REPORT")
 d file.WriteLine(",,2007-08 Item No,Item")
 d file.WriteLine(",,4,Service_Provider_ No,"_S1)
 d file.WriteLine(",,5,Date Collection Identifier,"_S2)
 d file.WriteLine(",,6,Transmission Number,"_S3)
 d file.WriteLine(",,8,Number of Service Records Following,"_S4)
 d file.WriteLine("")
 d file.WriteLine(",,Client Contacts Service Records")
 d file.WriteLine(",,16,Funding_Sources")
 s id=0 f  s id=$o(^zCacheTemp("VICPHMPRSummary",repid1,"S5",id)) q:id=""  d
 . s S5=..GetActualCode("ARC_InsuranceType","INST_Code","PH MPR",id)
 . i S5'="" s S5=##class(web.ARCInsuranceType).GetIdFromCodeOrDescription(S5)
 . i S5'="" s S5=$p($g(^ARC("INST",S5)),"^",2)
 . d file.WriteLine(",,,"_S5)
 d file.WriteLine("")
 d file.WriteLine(",,17,Service_Type")
 s id=0 f  s id=$o(^zCacheTemp("VICPHMPRSummary",repid1,"S6",id)) q:id=""  d
 . s S6=..GetActualCode("ARC_ItemCat","ARCIC_Code","PH MPR",id)
 . i S6'="" s S6=##class(web.ARCItemCat).GetIdFromCodeOrDescription(S6)
 . i S6'="" s S6=$p($g(^ARC("IC",S6)),"^",2)
 . d file.WriteLine(",,,"_S6)
 d file.WriteLine("")
 s id=0 f  s id=$o(^zCacheTemp("VICPHMPRSummary",repid1,"S8",id)) q:id=""  d
 . s S8=$i(S8)
 d file.WriteLine(",,22,Unique_Client_Identifier,"_S8)
 d file.WriteLine("")
 d file.WriteLine(",,20,Contact_Type_Indicator = 1,"_S9)
 d file.WriteLine(",,,Contact_Type_Indicator = 2,"_S10)
 d file.WriteLine(",,43,Session_Attendees,"_S11)
 d file.WriteLine("")
 d file.WriteLine(",,21,Client_Type = C,"_S12)
 d file.WriteLine(",,,Client_Type = R,"_S13)
 d file.WriteLine(",,,Client_Type = O,"_S14)
 d file.WriteLine("")
 ;d file.WriteLine(",,18,Program_Priority_Issues")
 ;s id=0 f  s id=$o(^zCacheTemp("VICPHMPRSummary",repid1,"S15",id)) q:id=""  d
 . ;s S15=..GetActualCode("OEC_ConsultCateg","CONS_Code","PH MPR",id)
 .; i S15'="" s S15=##class(web.OECConsultCateg).GetIdFromCodeOrDescription(S15)
 . ;i S15'="" s S15=$p($g(^OEC("CONS",S15)),"^",2)
 . ;d file.WriteLine(",,,"_S15)
 d ;file.WriteLine("")
 d ;file.WriteLine(",,19,Target_Population_Groups")
 ;s id=0 f  s id=$o(^zCacheTemp("VICPHMPRSummary",repid1,"S16",id)) q:id=""  d
 . ;s S16=..GetActualCode("PAC_SourceOfReferral","SOR_Code","PH MPR",id)
 . ;i S16'="" s S16=##class(web.PACSourceOfReferral).GetIdFromCodeOrDescription(S16)
 . ;i S16'="" s S16=$p($g(^PAC("SOR",S16)),"^",2)
 . ;d file.WriteLine(",,,"_S16)
 ;d file.WriteLine("")
 d file.WriteLine(",,,,,,,,,,,,Agency TOTAL HOURS,Agency TOTAL FEES CHARGED")
 d file.WriteLine(",,,,,,,Item,Item,Item,Item,,,Item")
 d file.WriteLine(",,,,,,,39,40,41,42,,,38")
 d file.WriteLine("Line,Activity Number,Funding Code,Activity Name,Service Code,Reported Activities,Count of Client Contacts,Direct Time,Indirect Time,Travel Time,Interpreting Time,TOTAL,Funding Source Total Hours,Fees Charged")
 d file.WriteLine(",,Health Promotion")
 d file.WriteLine("1,28001,1,Community Health - Health Promotion,15,Health Promotion,"_S17_","_S18_","_S19_","_S20_","_S21_","_S22_",,$"_S23)
 d file.WriteLine("2,28050,2,Women's Health - Health Promotion,15,Health Promotion,"_S24_","_S25_","_S26_","_S27_","_S28_","_S29_",,$"_S30)
 d file.WriteLine("3,28021,5,Innovative Health Services for Homeless Youth - Health Promotion,15,Health Promotion,"_S31_","_S32_","_S33_","_S34_","_S35_","_S36_",,$"_S37)
 d file.WriteLine("4,28018,4,Family Planning - Health Promotion,15,Health Promotion,"_S38_","_S39_","_S40_","_S41_","_S42_","_S43_",,$"_S44)
 d file.WriteLine("5,28024,7,Suicide Prevention - Health Promotion,15,Health Promotion,"_S45_","_S46_","_S47_","_S48_","_S49_","_S50_",,$"_S51)
 d file.WriteLine("6,28016,9,Family And Reproductive Rights Education Program - Health Promotion,15,Health Promotion,"_S52_","_S53_","_S54_","_S55_","_S56_","_S57_",,$"_S58)
 d file.WriteLine("7,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,15,Health Promotion,"_S59_","_S60_","_S61_","_S62_","_S63_","_S64_",,$"_S65)
 d file.WriteLine("8,28072,19,Community Health - Integrated Chronic Disease Management,15,Health Promotion,"_S66_","_S67_","_S68_","_S69_","_S70_","_S71_",,$"_S72)
 d file.WriteLine("9,28074,20,Community Health - Diabetes Self Management,15,Health Promotion,"_S73_","_S74_","_S75_","_S76_","_S77_","_S78_",,$"_S79)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S80_",$"_S81)
 d file.WriteLine(",,Community Health - Direct Care")
 d file.WriteLine("10,28065,1,Community Health - Direct Care,1,Audiology,"_S82_","_S83_","_S84_","_S85_","_S86_","_S87_",,$"_S88)
 d file.WriteLine("11,28065,1,Community Health - Direct Care,2,Dietetics,"_S89_","_S90_","_S91_","_S92_","_S93_","_S94_",,$"_S95)
 d file.WriteLine("12,28065,1,Community Health - Direct Care,3,Occupational Therapy,"_S96_","_S97_","_S98_","_S99_","_S100_","_S101_",,$"_S102)
 d file.WriteLine("13,28065,1,Community Health - Direct Care,4,Physiotherapy,"_S103_","_S104_","_S105_","_S106_","_S107_","_S108_",,$"_S109)
 d file.WriteLine("14,28065,1,Community Health - Direct Care,5,Podiatry,"_S110_","_S111_","_S112_","_S113_","_S114_","_S115_",,$"_S116)
 d file.WriteLine("15,28065,1,Community Health - Direct Care,6,Speech Therapy,"_S117_","_S118_","_S119_","_S120_","_S121_","_S122_",,$"_S123)
 d file.WriteLine("16,28065,1,Community Health - Direct Care,7,Nursing,"_S124_","_S125_","_S126_","_S127_","_S128_","_S129_",,$"_S130)
 d file.WriteLine("17,28065,1,Community Health - Direct Care,8,Counselling,"_S117A_","_S118A_","_S119A_","_S120A_","_S121A_","_S122A_",,$"_S123A)
 d file.WriteLine("18,28065,1,Community Health - Direct Care,41,Care Coordination,"_S530_","_S531_","_S532_","_S533_","_S534_","_S535_",,$"_S536)
 d file.WriteLine("19,28065,1,Community Health - Direct Care,43,Education and Training,"_S540_","_S541_","_S542_","_S543_","_S544_","_S545_",,$"_S546)
 d file.WriteLine("20,28065,1,Community Health - Direct Care,44,Clinical Services and Training,"_S550_","_S551_","_S552_","_S553_","_S554_","_S555_",,$"_S556)
 d file.WriteLine("21,28065,1,Community Health - Direct Care,45,Initial Needs Identification,"_S131_","_S132_","_S133_","_S134_","_S135_","_S136_",,$"_S137)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S138_",$"_S139)
 d file.WriteLine(",,Women's Health - Direct Care")
 d file.WriteLine("22,28067,2,Women's Health - Direct Care,7,Nursing,"_S148_","_S149_","_S150_","_S151_","_S152_","_S153_",,$"_S154)
 d file.WriteLine("23,28067,2,Women's Health - Direct Care,8,Counselling,"_S141_","_S142_","_S143_","_S144_","_S145_","_S146_",,$"_S147)
 d file.WriteLine("24,28067,2,Women's Health - Direct Care,41,Care Coordination,"_S630_","_S631_","_S632_","_S633_","_S634_","_S635_",,$"_S636)
 d file.WriteLine("25,28067,2,Women's Health - Direct Care,43,Education and Training,"_S640_","_S641_","_S642_","_S643_","_S644_","_S645_",,$"_S646)
 d file.WriteLine("26,28067,2,Women's Health - Direct Care,44,Clinical Services and Training,"_S650_","_S651_","_S652_","_S653_","_S654_","_S655_",,$"_S656)
 d file.WriteLine("27,28067,2,Women's Health - Direct Care,45,Initial Needs Identification,"_S155_","_S156_","_S157_","_S158_","_S159_","_S160_",,$"_S161)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S162_",$"_S163)
 d file.WriteLine(",,Family Planning")
 d file.WriteLine("28,28068,4,Family Planning - Direct Care,7,Nursing,"_S185_","_S186_","_S187_","_S188_","_S189_","_S190_",,$"_S191)
 d file.WriteLine("29,28068,4,Family Planning - Direct Care,8,Counselling,"_S178_","_S179_","_S180_","_S181_","_S182_","_S183_",,$"_S184)
 d file.WriteLine("30,28068,4,Family Planning - Direct Care,41,Care Coordination,"_S730_","_S731_","_S732_","_S733_","_S734_","_S735_",,$"_S736)
 d file.WriteLine("31,28068,4,Family Planning - Direct Care,43,Education and Training,"_S164_","_S165_","_S166_","_S167_","_S168_","_S169_",,$"_S170)
 d file.WriteLine("32,28068,4,Family Planning - Direct Care,44,Clinical Services and Training,"_S171_","_S172_","_S173_","_S174_","_S175_","_S176_",,$"_S177)
 d file.WriteLine("33,28068,4,Family Planning - Direct Care,45,Initial Needs Identification,"_S192_","_S193_","_S194_","_S195_","_S196_","_S197_",,$"_S198)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S199_",$"_S200)
 d file.WriteLine(",,Innovative Health Services for Homeless Youth - Direct Care")
 d file.WriteLine("34,28066,5,Innovative Health Services for Homeless Youth - Direct Care,7,Nursing,"_S208_","_S209_","_S210_","_S211_","_S212_","_S213_",,$"_S214)
 d file.WriteLine("35,28066,5,Innovative Health Services for Homeless Youth - Direct Care,8,Counselling,"_S201_","_S202_","_S203_","_S204_","_S205_","_S206_",,$"_S207)
 d file.WriteLine("36,28066,5,Innovative Health Services for Homeless Youth - Direct Care,41,Care Coordination,"_S830_","_S831_","_S832_","_S833_","_S834_","_S835_",,$"_S836)
 d file.WriteLine("37,28066,5,Innovative Health Services for Homeless Youth - Direct Care,43,Education and Training,"_S840_","_S841_","_S842_","_S843_","_S844_","_S845_",,$"_S846)
 d file.WriteLine("38,28066,5,Innovative Health Services for Homeless Youth - Direct Care,44,Clinical Services and Training,"_S850_","_S851_","_S852_","_S853_","_S854_","_S855_",,$"_S856)
 d file.WriteLine("39,28066,5,Innovative Health Services for Homeless Youth - Direct Care,45,Initial Needs Identification,"_S215_","_S216_","_S217_","_S218_","_S219_","_S220_",,$"_S221)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S222_",$"_S223)
 d file.WriteLine(",,Suicide Prevention - Direct Care")
 d file.WriteLine("40,28023,7,Suicide Prevention - Direct Care,8,Counselling,"_S224_","_S225_","_S226_","_S227_","_S228_","_S229_",,$"_S230)
 d file.WriteLine("41,28023,7,Suicide Prevention - Direct Care,41,Care Coordination,"_S930_","_S931_","_S932_","_S933_","_S934_","_S935_",,$"_S936)
 d file.WriteLine("42,28023,7,Suicide Prevention - Direct Care,43,Education and Training,"_S940_","_S941_","_S942_","_S943_","_S944_","_S945_",,$"_S946)
 d file.WriteLine("43,28023,7,Suicide Prevention - Direct Care,44,Clinical Services and Training,"_S950_","_S951_","_S952_","_S953_","_S954_","_S955_",,$"_S956)
 d file.WriteLine("44,28023,7,Suicide Prevention - Direct Care,45,Initial Needs Identification,"_S231_","_S232_","_S233_","_S234_","_S235_","_S236_",,$"_S237)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S238_",$"_S239)
 d file.WriteLine(",,Family And Reproductive Rights Education Program - Direct Care")
 d file.WriteLine("45,28015,9,Family And Reproductive Rights Education Program - Direct Care,8,Counselling,"_S240_","_S241_","_S242_","_S243_","_S244_","_S245_",,$"_S246)
 d file.WriteLine("46,28015,9,Family And Reproductive Rights Education Program - Direct Care,41,Care Coordination,"_S1030_","_S1031_","_S1032_","_S1033_","_S1034_","_S1035_",,$"_S1036)
 d file.WriteLine("47,28015,9,Family And Reproductive Rights Education Program - Direct Care,43,Education and Training,"_S1040_","_S1041_","_S1042_","_S1043_","_S1044_","_S1045_",,$"_S1046)
 d file.WriteLine("48,28015,9,Family And Reproductive Rights Education Program - Direct Care,44,Clinical Services and Training,"_S1050_","_S1051_","_S1052_","_S1053_","_S1054_","_S1055_",,$"_S1056)
 d file.WriteLine("49,28015,9,Family And Reproductive Rights Education Program - Direct Care,45,Initial Needs Identification,"_S247_","_S248_","_S249_","_S250_","_S251_","_S252_",,$"_S253)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S254_",$"_S255)
 d file.WriteLine(",,Refugee Health Nurse")
 d file.WriteLine("50,28076,21,Refugee Health Nurse,1,Audiology,"_S1510_","_S1511_","_S1512_","_S1513_","_S1514_","_S1515_",,$"_S1516)
 d file.WriteLine("51,28076,21,Refugee Health Nurse,2,Dietetics,"_S1520_","_S1521_","_S1522_","_S1523_","_S1524_","_S1525_",,$"_S1526)
 d file.WriteLine("52,28076,21,Refugee Health Nurse,3,Occupational Therapy,"_S1570_","_S1571_","_S1572_","_S1573_","_S1574_","_S1575_",,$"_S1576)
 d file.WriteLine("53,28076,21,Refugee Health Nurse,4,Physiotherapy,"_S1580_","_S1581_","_S1582_","_S1583_","_S1584_","_S1585_",,$"_S1586)
 d file.WriteLine("54,28076,21,Refugee Health Nurse,5,Podiatry,"_S1590_","_S1591_","_S1592_","_S1593_","_S1594_","_S1595_",,$"_S1596)
 d file.WriteLine("55,28076,21,Refugee Health Nurse,6,Speech Therapy,"_S1610_","_S1611_","_S1612_","_S1613_","_S1614_","_S1615_",,$"_S1616)
 d file.WriteLine("56,28076,21,Refugee Health Nurse,7,Nursing,"_S1630_","_S1631_","_S1632_","_S1633_","_S1634_","_S1635_",,$"_S1636)
 d file.WriteLine("57,28076,21,Refugee Health Nurse,8,Counselling,"_S1620_","_S1621_","_S1622_","_S1623_","_S1624_","_S1625_",,$"_S1626)
 d file.WriteLine("58,28076,21,Refugee Health Nurse,41,Care Coordination,"_S1530_","_S1531_","_S1532_","_S1533_","_S1534_","_S1535_",,$"_S1536)
 d file.WriteLine("59,28076,21,Refugee Health Nurse,43,Education and Training,"_S1540_","_S1541_","_S1542_","_S1543_","_S1544_","_S1545_",,$"_S1546)
 d file.WriteLine("60,28076,21,Refugee Health Nurse,44,Clinical Services and Training,"_S1550_","_S1551_","_S1552_","_S1553_","_S1554_","_S1555_",,$"_S1556)
 d file.WriteLine("61,28076,21,Refugee Health Nurse,45,Initial Needs Identification,"_S1640_","_S1641_","_S1642_","_S1643_","_S1644_","_S1645_",,$"_S1646)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S1648_",$"_S1649)
 d file.WriteLine(",,Small Rural - Primary Health Care Services")
 d file.WriteLine("62,35047,12,Small Rural - Primary Health Care Services,1,Audiology,"_S256_","_S257_","_S258_","_S259_","_S260_","_S261_",,$"_S262)
 d file.WriteLine("63,35047,12,Small Rural - Primary Health Care Services,2,Dietetics,"_S263_","_S264_","_S265_","_S266_","_S267_","_S268_",,$"_S269)
 d file.WriteLine("64,35047,12,Small Rural - Primary Health Care Services,3,Occupational Therapy,"_S270_","_S271_","_S272_","_S273_","_S274_","_S275_",,$"_S276)
 d file.WriteLine("65,35047,12,Small Rural - Primary Health Care Services,4,Physiotherapy,"_S277_","_S278_","_S279_","_S280_","_S281_","_S282_",,$"_S283)
 d file.WriteLine("66,35047,12,Small Rural - Primary Health Care Services,5,Podiatry,"_S284_","_S285_","_S286_","_S287_","_S288_","_S289_",,$"_S290)
 d file.WriteLine("67,35047,12,Small Rural - Primary Health Care Services,6,Speech Therapy,"_S291_","_S292_","_S293_","_S294_","_S295_","_S296_",,$"_S297)
 d file.WriteLine("68,35047,12,Small Rural - Primary Health Care Services,7,Nursing,"_S305_","_S306_","_S307_","_S308_","_S309_","_S310_",,$"_S311)
 d file.WriteLine("69,35047,12,Small Rural - Primary Health Care Services,8,Counselling,"_S298_","_S299_","_S300_","_S301_","_S302_","_S303_",,$"_S304)
 d file.WriteLine("70,35047,12,Small Rural - Primary Health Care Services,15,Health Promotion,"_S319_","_S320_","_S321_","_S322_","_S323_","_S324_",,$"_S325)
 d file.WriteLine("71,35047,12,Small Rural - Primary Health Care Services,41,Care Coordination,"_S1130_","_S1131_","_S1132_","_S1133_","_S1134_","_S1135_",,$"_S1136)
 d file.WriteLine("72,35047,12,Small Rural - Primary Health Care Services,43,Education and Training,"_S1140_","_S1141_","_S1142_","_S1143_","_S1144_","_S1145_",,$"_S1146)
 d file.WriteLine("73,35047,12,Small Rural - Primary Health Care Services,44,Clinical Services and Training,"_S1150_","_S1151_","_S1152_","_S1153_","_S1154_","_S1155_",,$"_S1156)
 d file.WriteLine("74,35047,12,Small Rural - Primary Health Care Services,45,Initial Needs Identification,"_S312_","_S313_","_S314_","_S315_","_S316_","_S317_",,$"_S318)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S326_",$"_S327)
 d file.WriteLine(",,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership")
 d file.WriteLine("75,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,1,Audiology,"_S328_","_S329_","_S330_","_S331_","_S332_","_S333_",,$"_S334)
 d file.WriteLine("76,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,2,Dietetics,"_S335_","_S336_","_S337_","_S338_","_S339_","_S340_",,$"_S341)
 d file.WriteLine("77,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,3,Occupational Therapy,"_S342_","_S343_","_S344_","_S345_","_S346_","_S347_",,$"_S348)
 d file.WriteLine("78,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,4,Physiotherapy,"_S349_","_S350_","_S351_","_S352_","_S353_","_S354_",,$"_S355)
 d file.WriteLine("79,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,5,Podiatry,"_S356_","_S357_","_S358_","_S359_","_S360_","_S361_",,$"_S362)
 d file.WriteLine("80,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,6,Speech Therapy,"_S363_","_S364_","_S365_","_S366_","_S367_","_S368_",,$"_S369)
 d file.WriteLine("81,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,7,Nursing,"_S377_","_S378_","_S379_","_S380_","_S381_","_S382_",,$"_S383)
 d file.WriteLine("82,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,8,Counselling,"_S370_","_S371_","_S372_","_S373_","_S374_","_S375_",,$"_S376)
 d file.WriteLine("83,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,41,Care Coordination,"_S1230_","_S1231_","_S1232_","_S1233_","_S1234_","_S1235_",,$"_S1236)
 d file.WriteLine("84,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,43,Education and Training,"_S1240_","_S1241_","_S1242_","_S1243_","_S1244_","_S1245_",,$"_S1246)
 d file.WriteLine("85,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,44,Clinical Services and Training,"_S1250_","_S1251_","_S1252_","_S1253_","_S1254_","_S1255_",,$"_S1256)
 d file.WriteLine("86,28071,18,Aboriginal Health Promotion and Chronic Care  (AHPACC) Partnership,45,Initial Needs Identification,"_S384_","_S385_","_S386_","_S387_","_S388_","_S389_",,$"_S390)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S391_",$"_S392)
 d file.WriteLine(",,Community Health - Integrated Chronic Disease Management")
 d file.WriteLine("87,28072,19,Community Health - Integrated Chronic Disease Management,1,Audiology,"_S393_","_S394_","_S395_","_S396_","_S397_","_S398_",,$"_S399)
 d file.WriteLine("88,28072,19,Community Health - Integrated Chronic Disease Management,2,Dietetics,"_S400_","_S401_","_S402_","_S403_","_S404_","_S405_",,$"_S406)
 d file.WriteLine("89,28072,19,Community Health - Integrated Chronic Disease Management,3,Occupational Therapy,"_S407_","_S408_","_S409_","_S410_","_S411_","_S412_",,$"_S413)
 d file.WriteLine("90,28072,19,Community Health - Integrated Chronic Disease Management,4,Physiotherapy,"_S414_","_S415_","_S416_","_S417_","_S418_","_S419_",,$"_S420)
 d file.WriteLine("91,28072,19,Community Health - Integrated Chronic Disease Management,5,Podiatry,"_S421_","_S422_","_S423_","_S424_","_S425_","_S426_",,$"_S427)
 d file.WriteLine("92,28072,19,Community Health - Integrated Chronic Disease Management,6,Speech Therapy,"_S428_","_S429_","_S430_","_S431_","_S432_","_S433_",,$"_S434)
 d file.WriteLine("93,28072,19,Community Health - Integrated Chronic Disease Management,7,Nursing,"_S442_","_S443_","_S444_","_S445_","_S446_","_S447_",,$"_S448)
 d file.WriteLine("94,28072,19,Community Health - Integrated Chronic Disease Management,8,Counselling,"_S435_","_S436_","_S437_","_S438_","_S439_","_S440_",,$"_S441)
 d file.WriteLine("95,28072,19,Community Health - Integrated Chronic Disease Management,41,Care Coordination,"_S1330_","_S1331_","_S1332_","_S1333_","_S1334_","_S1335_",,$"_S1336)
 d file.WriteLine("96,28072,19,Community Health - Integrated Chronic Disease Management,43,Education and Training,"_S1340_","_S1341_","_S1342_","_S1343_","_S1344_","_S1345_",,$"_S1346)
 d file.WriteLine("97,28072,19,Community Health - Integrated Chronic Disease Management,44,Clinical Services and Training,"_S1350_","_S1351_","_S1352_","_S1353_","_S1354_","_S1355_",,$"_S1356)
 d file.WriteLine("98,28072,19,Community Health - Integrated Chronic Disease Management,45,Initial Needs Identification,"_S449_","_S450_","_S451_","_S452_","_S453_","_S454_",,$"_S455)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S456_",$"_S457)
 d file.WriteLine(",,Community Health - Diabetes Self Management")
 d file.WriteLine("99,28074,20,Community Health - Diabetes Self Management,1,Audiology,"_S458_","_S459_","_S460_","_S461_","_S462_","_S463_",,$"_S464)
 d file.WriteLine("100,28074,20,Community Health - Diabetes Self Management,2,Dietetics,"_S465_","_S466_","_S467_","_S468_","_S469_","_S470_",,$"_S471)
 d file.WriteLine("101,28074,20,Community Health - Diabetes Self Management,3,Occupational Therapy,"_S472_","_S473_","_S474_","_S475_","_S476_","_S477_",,$"_S478)
 d file.WriteLine("102,28074,20,Community Health - Diabetes Self Management,4,Physiotherapy,"_S479_","_S480_","_S481_","_S482_","_S483_","_S484_",,$"_S485)
 d file.WriteLine("103,28074,20,Community Health - Diabetes Self Management,5,Podiatry,"_S486_","_S487_","_S488_","_S489_","_S490_","_S491_",,$"_S492)
 d file.WriteLine("104,28074,20,Community Health - Diabetes Self Management,6,Speech Therapy,"_S493_","_S494_","_S495_","_S496_","_S497_","_S498_",,$"_S499)
 d file.WriteLine("105,28074,20,Community Health - Diabetes Self Management,7,Nursing,"_S507_","_S508_","_S509_","_S510_","_S511_","_S512_",,$"_S513)
 d file.WriteLine("106,28074,20,Community Health - Diabetes Self Management,8,Counselling,"_S500_","_S501_","_S502_","_S503_","_S504_","_S505_",,$"_S506)
 d file.WriteLine("107,28074,20,Community Health - Diabetes Self Management,41,Care Coordination,"_S1430_","_S1431_","_S1432_","_S1433_","_S1434_","_S1435_",,$"_S1436)
 d file.WriteLine("108,28074,20,Community Health - Diabetes Self Management,43,Education and Training,"_S1440_","_S1441_","_S1442_","_S1443_","_S1444_","_S1445_",,$"_S1446)
 d file.WriteLine("109,28074,20,Community Health - Diabetes Self Management,44,Clinical Services and Training,"_S1450_","_S1451_","_S1452_","_S1453_","_S1454_","_S1455_",,$"_S1456)
 d file.WriteLine("110,28074,20,Community Health - Diabetes Self Management,45,Initial Needs Identification,"_S514_","_S515_","_S516_","_S517_","_S518_","_S519_",,$"_S520)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S521_",$"_S522)
 d file.WriteLine(",,Healthy Mothers Healthy Babies")
 d file.WriteLine("111,28080,22,Healthy Mothers Healthy Babies,1,Audiology,"_S1710_","_S1711_","_S1712_","_S1713_","_S1714_","_S1715_",,$"_S1716)
 d file.WriteLine("112,28080,22,Healthy Mothers Healthy Babies,2,Dietetics,"_S1720_","_S1721_","_S1722_","_S1763_","_S1764_","_S1765_",,$"_S1766)
 d file.WriteLine("113,28080,22,Healthy Mothers Healthy Babies,3,Occupational Therapy,"_S1770_","_S1771_","_S1772_","_S1773_","_S1774_","_S1775_",,$"_S1776)
 d file.WriteLine("114,28080,22,Healthy Mothers Healthy Babies,4,Physiotherapy,"_S1780_","_S1781_","_S1782_","_S1783_","_S1784_","_S1785_",,$"_S1786)
 d file.WriteLine("115,28080,22,Healthy Mothers Healthy Babies,5,Podiatry,"_S1790_","_S1791_","_S1792_","_S1793_","_S1794_","_S1795_",,$"_S1796)
 d file.WriteLine("116,28080,22,Healthy Mothers Healthy Babies,6,Speech Therapy,"_S1810_","_S1811_","_S1812_","_S1813_","_S1814_","_S1815_",,$"_S1816)
 d file.WriteLine("117,28080,22,Healthy Mothers Healthy Babies,7,Nursing,"_S1830_","_S1831_","_S1832_","_S1833_","_S1834_","_S1835_",,$"_S1836)
 d file.WriteLine("118,28080,22,Healthy Mothers Healthy Babies,8,Counselling,"_S1820_","_S1821_","_S1822_","_S1823_","_S1824_","_S1825_",,$"_S1826)
 d file.WriteLine("119,28080,22,Healthy Mothers Healthy Babies,41,Care Coordination,"_S1730_","_S1731_","_S1732_","_S1733_","_S1734_","_S1735_",,$"_S1736)
 d file.WriteLine("120,28080,22,Healthy Mothers Healthy Babies,43,Education and Training,"_S1740_","_S1741_","_S1742_","_S1743_","_S1744_","_S1745_",,$"_S1746)
 d file.WriteLine("121,28080,22,Healthy Mothers Healthy Babies,44,Clinical Services and Training,"_S1750_","_S1751_","_S1752_","_S1753_","_S1754_","_S1755_",,$"_S1756)
 d file.WriteLine("122,28080,22,Healthy Mothers Healthy Babies,45,Initial Needs Identification,"_S1840_","_S1841_","_S1842_","_S1843_","_S1844_","_S1845_",,$"_S1846)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S1848_",$"_S1849)
 d file.WriteLine(",,Kids Life")
 d file.WriteLine("123,20802,23,Kids Life,1,Audiology,"_S1910_","_S1911_","_S1912_","_S1913_","_S1914_","_S1915_",,$"_S1916)
 d file.WriteLine("124,20802,23,Kids Life,2,Dietetics,"_S1920_","_S1921_","_S1922_","_S1963_","_S1964_","_S1965_",,$"_S1966)
 d file.WriteLine("125,20802,23,Kids Life,3,Occupational Therapy,"_S1970_","_S1971_","_S1972_","_S1973_","_S1974_","_S1975_",,$"_S1976)
 d file.WriteLine("126,20802,23,Kids Life,4,Physiotherapy,"_S1980_","_S1981_","_S1982_","_S1983_","_S1984_","_S1985_",,$"_S1986)
 d file.WriteLine("127,20802,23,Kids Life,5,Podiatry,"_S1990_","_S1991_","_S1992_","_S1993_","_S1994_","_S1995_",,$"_S1996)
 d file.WriteLine("128,20802,23,Kids Life,6,Speech Therapy,"_S2010_","_S2011_","_S2012_","_S2013_","_S2014_","_S2015_",,$"_S2016)
 d file.WriteLine("129,20802,23,Kids Life,7,Nursing,"_S2030_","_S2031_","_S2032_","_S2033_","_S2034_","_S2035_",,$"_S2036)
 d file.WriteLine("130,20802,23,Kids Life,8,Counselling,"_S2020_","_S2021_","_S2022_","_S2023_","_S2024_","_S2025_",,$"_S2026)
 d file.WriteLine("131,20802,23,Kids Life,41,Care Coordination,"_S1930_","_S1931_","_S1932_","_S1933_","_S1934_","_S1935_",,$"_S1936)
 d file.WriteLine("132,20802,23,Kids Life,43,Education and Training,"_S1940_","_S1941_","_S1942_","_S1943_","_S1944_","_S1945_",,$"_S1946)
 d file.WriteLine("133,20802,23,Kids Life,44,Clinical Services and Training,"_S1950_","_S1951_","_S1952_","_S1953_","_S1954_","_S1955_",,$"_S1956)
 d file.WriteLine("134,20802,23,Kids Life,45,Initial Needs Identification,"_S2040_","_S2041_","_S2042_","_S2043_","_S2044_","_S2045_",,$"_S2046)
 d file.WriteLine(",,,,,,,,,,,Sub Total,"_S2048_",$"_S2049)
 d file.WriteLine("")
 d file.WriteLine(",,,,,,,,,,,Summary Total,"_S523_",$"_S524)
 d file.WriteLine("")
 d file.WriteLine(",,,,,,,,,,,Extract Total,"_S525_",$"_S526)
 
 d file.Close()
 
 k ^zCacheTemp("VICPHMPRSummary",repid1)
 q 1
]]></Implementation>
</Method>

<Method name="QDCSummary">
<Description>
DO NOT USE
TRC88408 - Summary not used anymore.  Moved to VICQDCExtract class.</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>filepath:%Library.String,date:%Library.String,time:%Library.String</FormalSpec>
<Implementation><![CDATA[
 s repid1=$i(^zCacheTemp("VICQDCSummary"))
 k ^zCacheTemp("VICQDCSummary",repid1)
 
 n id,S1,S2,S3,S4,S5,S6,agencycode,S1A,qid
 s (id,S1,S2,S3,S4,S5,S6,agencycode,S1A,qid)=""
 
 s agencycode=$o(^PAC("TRUST",0))
 i agencycode'="" d
 . s agencycode=$p($g(^PAC("TRUST",agencycode)),"^",1)
 . i agencycode'="" s agencycode=##class(Custom.VICQDCExtract).GetMappedCode("PAC_Trust","TRUST_Code","QDC1",$g(agencycode))
 
 k ValidS1
 s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","QDC",date,time,id)) q:id=""  d
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ELEMENT1" d
 . . s S2=$p($g(^Custom.ExtractSummaries(id)),"^",11)
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ELEMENT2" d
 . . s S1=$p($g(^Custom.ExtractSummaries(id)),"^",42)
 . . i $g(S1)'="" s ValidS1(S1)="1"
 . . i $g(^zCacheTemp("VICQDCSummary",repid1,"S5","Element 2  Summary,,"))'="" d
 . . . i $g(^zCacheTemp("VICQDCSummary",repid1,"S5","Element 2  Summary,,"))'=S1 d
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","Element 2  Summary,,")=$zstrip($g(^zCacheTemp("VICQDCSummary",repid1,"S5","Element 2  Summary,,")),"*P")_","_$g(S1)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S01,AIHWServiceType,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S01,AIHWServiceType,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",10)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S02,FullQuarterOperation,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S02,FullQuarterOperation,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",11)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S03,WeeksPerQuarter,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S03,WeeksPerQuarter,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",12)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S04,DaysPerWeek,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S04,DaysPerWeek,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",13)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S05,HoursPerDay,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S05,HoursPerDay,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",14)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S06,CurrentCapacity,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S06,CurrentCapacity,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",15)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S07,OutletTypePDSS-RR,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S07,OutletTypePDSS-RR,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",16)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S08,PaidStaffHrsRefWeek,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S08,PaidStaffHrsRefWeek,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",17)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S09,UnPaidStaffHrsRefWeek,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S09,UnPaidStaffHrsRefWeek,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",18)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S10,StaffEngagedDirect,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S10,StaffEngagedDirect,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",19)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S11,StaffEngagedIndirect,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S11,StaffEngagedIndirect,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",20)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S12,SleepOverNights,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S12,SleepOverNights,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",21)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S13,NbrServiceUsers,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S13,NbrServiceUsers,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",22)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S14,MSSHActivitiesProvided,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S14,MSSHActivitiesProvided,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",24)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S18,SupportGroupsConsumers,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S18,SupportGroupsConsumers,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",26)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S19,ParticipantsConsumers,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S19,ParticipantsConsumers,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",27)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S20,SupportGroupsCarer-Fam-Frnd,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S20,SupportGroupsCarer-Fam-Frnd,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",28)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S21,ParticipantsCarers-Fam-Frnd,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S21,ParticipantsCarers-Fam-Frnd,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",29)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S22,SupportGroupsFemale,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S22,SupportGroupsFemale,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",30)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S23,EdTrainGroupsConsumer,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S23,EdTrainGroupsConsumer,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",31)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S24,EdTrainParticipantsConsumer,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S24,EdTrainParticipantsConsumer,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",32)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S25,EdTrainGroupsCarerFamily,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S25,EdTrainGroupsCarerFamily,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",33)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S26,EdTrainParticipantsCarerFamily,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S26,EdTrainParticipantsCarerFamily,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",34)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S27,EdTrainGroupsCommunity,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S27,EdTrainGroupsCommunity,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",35)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S28,EdTrainParticipantsCommunity,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S28,EdTrainParticipantsCommunity,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",36)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S29,EdTrainGroupsProf,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S29,EdTrainGroupsProf,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",37)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S30,EdTrainParticipantsProf,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S30,EdTrainParticipantsProf,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",38)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S31,WaitingListExistence,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S31,WaitingListExistence,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",39)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S32,WaitingListNbrPeople,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S32,WaitingListNbrPeople,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",40)
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S40,AnnualQualityPlan,")=$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S40,AnnualQualityPlan,"))_","_$p($g(^Custom.ExtractSummaries(id)),"^",41)
 . . . . ;
 . . i $g(^zCacheTemp("VICQDCSummary",repid1,"S5","Element 2  Summary,,"))="" d
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","Element 2  Summary,,")=$g(S1)_"|"_$i(cnt)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S01,AIHWServiceType,")=$p($g(^Custom.ExtractSummaries(id)),"^",10)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S02,FullQuarterOperation,")=$p($g(^Custom.ExtractSummaries(id)),"^",11)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S03,WeeksPerQuarter,")=$p($g(^Custom.ExtractSummaries(id)),"^",12)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S04,DaysPerWeek,")=$p($g(^Custom.ExtractSummaries(id)),"^",13)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S05,HoursPerDay,")=$p($g(^Custom.ExtractSummaries(id)),"^",14)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S06,CurrentCapacity,")=$p($g(^Custom.ExtractSummaries(id)),"^",15)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S07,OutletTypePDSS-RR,")=$p($g(^Custom.ExtractSummaries(id)),"^",16)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S08,PaidStaffHrsRefWeek,")=$p($g(^Custom.ExtractSummaries(id)),"^",17)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S09,UnPaidStaffHrsRefWeek,")=$p($g(^Custom.ExtractSummaries(id)),"^",18)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S10,StaffEngagedDirect,")=$p($g(^Custom.ExtractSummaries(id)),"^",19)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S11,StaffEngagedIndirect,")=$p($g(^Custom.ExtractSummaries(id)),"^",20)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S12,SleepOverNights,")=$p($g(^Custom.ExtractSummaries(id)),"^",21)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S13,NbrServiceUsers,")=$p($g(^Custom.ExtractSummaries(id)),"^",22)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S14,MSSHActivitiesProvided,")=$p($g(^Custom.ExtractSummaries(id)),"^",24)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S18,SupportGroupsConsumers,")=$p($g(^Custom.ExtractSummaries(id)),"^",26)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S19,ParticipantsConsumers,")=$p($g(^Custom.ExtractSummaries(id)),"^",27)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S20,SupportGroupsCarer-Fam-Frnd,")=$p($g(^Custom.ExtractSummaries(id)),"^",28)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S21,ParticipantsCarers-Fam-Frnd,")=$p($g(^Custom.ExtractSummaries(id)),"^",29)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S22,SupportGroupsFemale,")=$p($g(^Custom.ExtractSummaries(id)),"^",30)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S23,EdTrainGroupsConsumer,")=$p($g(^Custom.ExtractSummaries(id)),"^",31)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S24,EdTrainParticipantsConsumer,")=$p($g(^Custom.ExtractSummaries(id)),"^",32)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S25,EdTrainGroupsCarerFamily,")=$p($g(^Custom.ExtractSummaries(id)),"^",33)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S26,EdTrainParticipantsCarerFamily,")=$p($g(^Custom.ExtractSummaries(id)),"^",34)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S27,EdTrainGroupsCommunity,")=$p($g(^Custom.ExtractSummaries(id)),"^",35)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S28,EdTrainParticipantsCommunity,")=$p($g(^Custom.ExtractSummaries(id)),"^",36)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S29,EdTrainGroupsProf,")=$p($g(^Custom.ExtractSummaries(id)),"^",37)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S30,EdTrainParticipantsProf,")=$p($g(^Custom.ExtractSummaries(id)),"^",38)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S31,WaitingListExistence,")=$p($g(^Custom.ExtractSummaries(id)),"^",39)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S32,WaitingListNbrPeople,")=$p($g(^Custom.ExtractSummaries(id)),"^",40)
 . . . s ^zCacheTemp("VICQDCSummary",repid1,"S5","S40,AnnualQualityPlan,")=$p($g(^Custom.ExtractSummaries(id)),"^",41)
 . . i $g(S1)'="" d
 . . . i '$d(^zCacheTemp("VICQDCSummary",repid1,"S1",S1)) s ^zCacheTemp("VICQDCSummary",repid1,"S1",S1)=0_"^"_0_"^"_0
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ELEMENT7" d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",342)'="" d
 . . . ;s qid=$p($g(^Custom.ExtractSummaries(id)),"^",6)
 . . . ;i qid'="" s qid=$o(^questionnaire.QQDCI("IndexPAAdmID",qid,""),-1)
 . . . ;i qid'="" s S1=$zstrip($lg(^questionnaire.QQDCD(qid),21),"*W")
 . . . s S1=$p($g(^Custom.ExtractSummaries(id)),"^",16)
 . . . i '$d(^zCacheTemp("VICQDCSummary",repid1,"S1",S1,$p($g(^Custom.ExtractSummaries(id)),"^",342))) d
 . . . . s $p(^zCacheTemp("VICQDCSummary",repid1,"S1",S1),"^",2)=$p($g(^zCacheTemp("VICQDCSummary",repid1,"S1",S1)),"^",2)+1
 . . . . s ^zCacheTemp("VICQDCSummary",repid1,"S1",S1,$p($g(^Custom.ExtractSummaries(id)),"^",342))=""
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ELEMENT6" d
 . . s S1A=$p($g(^Custom.ExtractSummaries(id)),"^",16)
 . . i S1A'="" d
 . . . i '$d(^zCacheTemp("VICQDCSummary",repid1,"S1",S1A)) s ^zCacheTemp("VICQDCSummary",repid1,"S1",S1A)=0_"^"_0_"^"_0
 . . . i $p($g(^Custom.ExtractSummaries(id)),"^",11)'="" s $p(^zCacheTemp("VICQDCSummary",repid1,"S1",S1A),"^",1)=$p(^zCacheTemp("VICQDCSummary",repid1,"S1",S1A),"^",1)+1
 . . i S1A="" d
 . . . i $p($g(^Custom.ExtractSummaries(id)),"^",11)'="" s $p(^zCacheTemp("VICQDCSummary",repid1,"S1",S1),"^",1)=$p(^zCacheTemp("VICQDCSummary",repid1,"S1",S1),"^",1)+1
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ELEMENT7" d
 . . i S1A="" s S1A=S1
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",12)'="" s $p(^zCacheTemp("VICQDCSummary",repid1,"S1",S1A),"^",3)=$p($g(^Custom.ExtractSummaries(id)),"^",12)+$p(^zCacheTemp("VICQDCSummary",repid1,"S1",S1A),"^",3)
 . ;s S1A=""
 i $f(filepath,"/") s filename=$p(filepath,"/",$l(filepath,"/")-1)_".csv"
 i $f(filepath,"\") s filename=$p(filepath,"\",$l(filepath,"\")-1)_".csv"
 
 s filepath=filepath_"QDC Summary"_$e(filename,4,$l(filename))
 
 s file=##class(%File).%New(filepath)
 d file.Open("WSN")
 d file.WriteLine("QDC - EXTRACT SUMMARY REPORT")
 d file.WriteLine("Element 1,"_$g(agencycode)_",Agency ID")
 d file.WriteLine("Element 1,"_$g(S2)_",Reporting Quarter")
 d file.WriteLine(",Element 1,Element 6,Element 3,Element 7")
 d file.WriteLine(",service_type_outlet_codeno,end_date,Service Users,Service_hours")
 d file.WriteLine(",List of STO Numbers included,Count of Client with Discharge Date by STO,Count of Clients by STO ,Total Count of Service Hours by STO")
 s id=0 f  s id=$o(^zCacheTemp("VICQDCSummary",repid1,"S1",id)) q:id=""  d
 . d file.WriteLine(","_id_$s($g(ValidS1(id))'=1:" (No Element 2 Recorded)",1:"")_","_$p($g(^zCacheTemp("VICQDCSummary",repid1,"S1",id)),"^",1)_","_$p($g(^zCacheTemp("VICQDCSummary",repid1,"S1",id)),"^",2)_","_$p($g(^zCacheTemp("VICQDCSummary",repid1,"S1",id)),"^",3))
 d file.WriteLine("")
 d file.WriteLine("Element 2  Summary,,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","Element 2  Summary,,")))
 d file.WriteLine("S01,AIHWServiceType,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S01,AIHWServiceType,")))
 d file.WriteLine("S02,FullQuarterOperation,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S02,FullQuarterOperation,")))
 d file.WriteLine("S03,WeeksPerQuarter,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S03,WeeksPerQuarter,")))
 d file.WriteLine("S04,DaysPerWeek,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S04,DaysPerWeek,")))
 d file.WriteLine("S05,HoursPerDay,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S05,HoursPerDay,")))
 d file.WriteLine("S06,CurrentCapacity,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S06,CurrentCapacity,")))
 d file.WriteLine("S07,OutletTypePDSS-RR,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S07,OutletTypePDSS-RR,")))
 d file.WriteLine("S08,PaidStaffHrsRefWeek,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S08,PaidStaffHrsRefWeek,")))
 d file.WriteLine("S09,UnPaidStaffHrsRefWeek,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S09,UnPaidStaffHrsRefWeek,")))
 d file.WriteLine("S10,StaffEngagedDirect,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S10,StaffEngagedDirect,")))
 d file.WriteLine("S11,StaffEngagedIndirect,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S11,StaffEngagedIndirect,")))
 d file.WriteLine("S12,SleepOverNights,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S12,SleepOverNights,")))
 d file.WriteLine("S13,NbrServiceUsers,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S13,NbrServiceUsers,")))
 d file.WriteLine("S14,MSSHActivitiesProvided,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S14,MSSHActivitiesProvided,")))
 d file.WriteLine("S18,SupportGroupsConsumers,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S18,SupportGroupsConsumers,")))
 d file.WriteLine("S19,ParticipantsConsumers,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S19,ParticipantsConsumers,")))
 d file.WriteLine("S20,SupportGroupsCarer-Fam-Frnd,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S20,SupportGroupsCarer-Fam-Frnd,")))
 d file.WriteLine("S21,ParticipantsCarers-Fam-Frnd,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S21,ParticipantsCarers-Fam-Frnd,")))
 d file.WriteLine("S22,SupportGroupsFemale,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S22,SupportGroupsFemale,")))
 d file.WriteLine("S23,EdTrainGroupsConsumer,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S23,EdTrainGroupsConsumer,")))
 d file.WriteLine("S24,EdTrainParticipantsConsumer,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S24,EdTrainParticipantsConsumer,")))
 d file.WriteLine("S25,EdTrainGroupsCarerFamily,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S25,EdTrainGroupsCarerFamily,")))
 d file.WriteLine("S26,EdTrainParticipantsCarerFamily,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S26,EdTrainParticipantsCarerFamily,")))
 d file.WriteLine("S27,EdTrainGroupsCommunity,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S27,EdTrainGroupsCommunity,")))
 d file.WriteLine("S28,EdTrainParticipantsCommunity,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S28,EdTrainParticipantsCommunity,")))
 d file.WriteLine("S29,EdTrainGroupsProf,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S29,EdTrainGroupsProf,")))
 d file.WriteLine("S30,EdTrainParticipantsProf,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S30,EdTrainParticipantsProf,")))
 d file.WriteLine("S31,WaitingListExistence,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S31,WaitingListExistence,")))
 d file.WriteLine("S32,WaitingListNbrPeople,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S32,WaitingListNbrPeople,")))
 d file.WriteLine("S40,AnnualQualityPlan,"_$g(^zCacheTemp("VICQDCSummary",repid1,"S5","S40,AnnualQualityPlan,")))
 d file.Close()
 
 k ^zCacheTemp("VICQDCSummary",repid1)
 q 1
]]></Implementation>
</Method>

<Method name="ADISSummary">
<ClassMethod>1</ClassMethod>
<FormalSpec>filepath:%Library.String,date:%Library.String,time:%Library.String</FormalSpec>
<Implementation><![CDATA[
 s repid1=$i(^zCacheTemp("VICADISSummary"))
 k ^zCacheTemp("VICADISSummary",repid1)
 
 n id,agencycode,count
 s (id,agencycode,count)=""
 
 n S1,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,S24,S25,S26,S27,S28,S29,S30,S31,S32,S33,S34,S35,S36,S37
 s (S1,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,S24,S25,S26,S27,S28,S29,S30,S31,S32,S33,S34,S35,S36,S37)=""
 
 s agencycode=$o(^PAC("TRUST",0))
 i agencycode'="" d
 . s agencycode=$p($g(^PAC("TRUST",agencycode)),"^",1)
 . i agencycode'="" s agencycode=##class(Custom.VICADISExtract).GetMappedCode("PAC_Trust","TRUST_Code","ADIS",$g(agencycode))

 s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","ADIS",date,time,id)) q:id=""  d
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="OiOID",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="OiOID" d
 . . s S1=$p($g(^Custom.ExtractSummaries(id)),"^",12)
 . . s S2=$p($g(^Custom.ExtractSummaries(id)),"^",13)
 . . s S3=$p($g(^Custom.ExtractSummaries(id)),"^",11)
 . . i $g(S1)="" s S1=" "
 . . s ^zCacheTemp("VICADISSummary",repid1,"S1",S1)=S2
 . . s S4=agencycode
 . s S5=$e($p($p($p($g(^Custom.ExtractSummaries(id)),"^",4),"  ",2),".",1),3,$l($p($p($p($g(^Custom.ExtractSummaries(id)),"^",4),"  ",2),".",1)))
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="iOID",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="iOID" d
 . . ;
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",20)'="" d
 . . . i '$d(^zCacheTemp("VICADISSummary",repid1,"S5",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s ^zCacheTemp("VICADISSummary",repid1,"S5",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))=0
 . . . s ^zCacheTemp("VICADISSummary",repid1,"S5",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))=$g(^zCacheTemp("VICADISSummary",repid1,"S5",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10)))+1
 . . ;
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",90)="TRUE" d
 . . . i '$d(^zCacheTemp("VICADISSummary",repid1,"S8",S5,"TRUE")) s ^zCacheTemp("VICADISSummary",repid1,"S8",S5,"TRUE")=0
 . . . s ^zCacheTemp("VICADISSummary",repid1,"S8",S5,"TRUE")=$g(^zCacheTemp("VICADISSummary",repid1,"S8",S5,"TRUE"))+1
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",93)'="31/12/1899",$p($g(^Custom.ExtractSummaries(id)),"^",20)'="" d
 . . . i '$d(^zCacheTemp("VICADISSummary",repid1,"S12",S5,"31/12/1899")) s ^zCacheTemp("VICADISSummary",repid1,"S12",S5,"31/12/1899")=0
 . . . s ^zCacheTemp("VICADISSummary",repid1,"S12",S5,"31/12/1899")=$g(^zCacheTemp("VICADISSummary",repid1,"S12",S5,"31/12/1899"))+1
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",20)="" d
 . . . i '$d(^zCacheTemp("VICADISSummary",repid1,"S15",S5)) s ^zCacheTemp("VICADISSummary",repid1,"S15",S5)=0
 . . . s ^zCacheTemp("VICADISSummary",repid1,"S15",S5)=^zCacheTemp("VICADISSummary",repid1,"S15",S5)+$p($g(^Custom.ExtractSummaries(id)),"^",17)
 . ;
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="GiOID",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="GiOID" d
 . . s ^zCacheTemp("VICADISSummary",repid1,"S18",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))=""
 . . i '$d(^zCacheTemp("VICADISSummary",repid1,"S24",S5)) s ^zCacheTemp("VICADISSummary",repid1,"S24",S5)=0
 . . s ^zCacheTemp("VICADISSummary",repid1,"S24",S5)=$p($g(^Custom.ExtractSummaries(id)),"^",16)+$g(^zCacheTemp("VICADISSummary",repid1,"S24",S5))
 . ;
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="SiOID",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="SiOID" d
 . . s ^zCacheTemp("VICADISSummary",repid1,"S21",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))=""
 . . i '$d(^zCacheTemp("VICADISSummary",repid1,"S27",S5)) s ^zCacheTemp("VICADISSummary",repid1,"S27",S5)=0
 . . s ^zCacheTemp("VICADISSummary",repid1,"S27",S5)=$p($g(^Custom.ExtractSummaries(id)),"^",16)+^zCacheTemp("VICADISSummary",repid1,"S27",S5)
 . ;
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CiOID",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="CiOID" d
 . . s ^zCacheTemp("VICADISSummary",repid1,"S30",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))=""
 . ;
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ViOID",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="ViOID" d
 . . s ^zCacheTemp("VICADISSummary",repid1,"S33",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))=""
 . ;
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="LiOID",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="LiOID" d
 . . s ^zCacheTemp("VICADISSummary",repid1,"S36",S5,$p($g(^Custom.ExtractSummaries(id)),"^",10))=""
 
 i $f(filepath,"/") s filename=$p(filepath,"/",$l(filepath,"/")-1)_".csv"
 i $f(filepath,"\") s filename=$p(filepath,"\",$l(filepath,"\")-1)_".csv"
 
 s filepath=filepath_"ADIS Summary"_$e(filename,5,$l(filename))
 
 s file=##class(%File).%New(filepath)
 d file.Open("WSN")
 d file.WriteLine("Alcohol and Drugs - EXTRACT SUMMARY REPORT")
 d file.WriteLine("iAgencyKey,"_S3)
 d file.WriteLine("iAgencyCode,"_S4)
  d file.WriteLine("Outlet,sName,sAddress")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S1",id)) q:id=""  d
 . d file.WriteLine(","_id_","_$g(^zCacheTemp("VICADISSummary",repid1,"S1",id)))
 
 d file.WriteLine("")
 d file.WriteLine("Episodic Clients")
 d file.WriteLine("iEpisodeNo,Total Number of Episodic Clients Open during Quarter")
 s (S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,S24,S25,S26,S27,S28,S29,S30,S31,S32,S33,S34,S35,S36,S37)=0
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S5",id)) q:id=""  d
 . s S6=0
 . s count=0 f  s count=$o(^zCacheTemp("VICADISSummary",repid1,"S5",id,count)) q:count=""  d
 . . s S6=$i(S6)
 . s S7=S7+S6
 . d file.WriteLine(id_","_S6)
 d file.WriteLine("Total,"_S7)
 d file.WriteLine("")
 d file.WriteLine("bSignificantGoals,Total Number of Episodic Clients Meeting Significant Goals Achieved in Quarter")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S8",id)) q:id=""  d
 . s S9=$g(^zCacheTemp("VICADISSummary",repid1,"S8",id,"TRUE"))
 . s S10=S9+S10
 . d file.WriteLine(id_","_S9)
 d file.WriteLine("Total,"_S10)
 d file.WriteLine("")
 d file.WriteLine("dTerminationDate,Total Number of Episodic Clients Closed during Quarter")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S12",id)) q:id=""  d
 . s S12=$g(^zCacheTemp("VICADISSummary",repid1,"S12",id,"31/12/1899"))
 . s S13=S12+S13
 . d file.WriteLine(id_","_S12)
 d file.WriteLine("Total,"_S13)
 d file.WriteLine("")
 d file.WriteLine("iDuration,Total Hours (Duration) of Contacts during Quarter")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S15",id)) q:id=""  d
 . s S15=$g(^zCacheTemp("VICADISSummary",repid1,"S15",id))
 . s S16=S15+S16
 . d file.WriteLine(id_","_S15)
 d file.WriteLine("Total,"_S16)
 d file.WriteLine("")
 d file.WriteLine("Episodic Groups / Sessions")
 d file.WriteLine("dStartDate,Total Number of Group for Quarter - by Service and Target")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S18",id)) q:id=""  d
 . s S18=0
 . s count=0 f  s count=$o(^zCacheTemp("VICADISSummary",repid1,"S18",id,count)) q:count=""  d
 . . s S18=$i(S18)
 . . s S19=$i(S19)
 . d file.WriteLine(id_","_S18)
 d file.WriteLine("Total,"_S19)
 d file.WriteLine("")
 d file.WriteLine("iNoSessions,Total Number of Sessions for Quarter - by Service and Target")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S21",id)) q:id=""  d
 . s S21=0
 . s count=0 f  s count=$o(^zCacheTemp("VICADISSummary",repid1,"S21",id,count)) q:count=""  d
 . . s S21=$i(S21)
 . . s S22=$i(S22)
 . d file.WriteLine(id_","_S21)
 d file.WriteLine("Total,"_S22)
 d file.WriteLine("")
 d file.WriteLine("iNoClients,Total Number of Attendees for Groups - by Service and Target")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S24",id)) q:id=""  d
 . s S24=$g(^zCacheTemp("VICADISSummary",repid1,"S24",id))
 . s S25=S24+S25
 . d file.WriteLine(id_","_S24)
 d file.WriteLine("Total,"_S25)
 d file.WriteLine("")
 d file.WriteLine("iDuration,Total Number Duration of Groups - by Service and Target")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S27",id)) q:id=""  d
 . s S27=$g(^zCacheTemp("VICADISSummary",repid1,"S27",id))
 . s S28=S27+S28
 . d file.WriteLine(id_","_S27)
 d file.WriteLine("Total,"_S28)
 d file.WriteLine("")
 d file.WriteLine("Registered (Primary Health Service) Clients")
 d file.WriteLine("CiOID,Total Number of Registered Client (LDS) - by Service and Target")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S30",id)) q:id=""  d
 . s S30=0
 . s count=0 f  s count=$o(^zCacheTemp("VICADISSummary",repid1,"S30",id,count)) q:count=""  d
 . . s S30=$i(S30)
 . . s S31=$i(S31)
 . d file.WriteLine(id_","_S30)
 d file.WriteLine("Total,"_S31)
 d file.WriteLine("")
 d file.WriteLine("dVisitDate,Total Number of Contacts for Registered Client (LDS) - by Service and Target")
  s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S33",id)) q:id=""  d
 . s S33=0
 . s count=0 f  s count=$o(^zCacheTemp("VICADISSummary",repid1,"S33",id,count)) q:count=""  d
 . . s S33=$i(S33)
 . . s S34=$i(S34)
 . d file.WriteLine(id_","_S33)
 d file.WriteLine("Total,"_S34)
 d file.WriteLine("")
 d file.WriteLine("UnRegistered Contacts")
 d file.WriteLine("LiOID,Total Number of Contacts for UnRegistered Clients - by Service and Target")
 s id=0 f  s id=$o(^zCacheTemp("VICADISSummary",repid1,"S36",id)) q:id=""  d
 . s S36=0
 . s count=0 f  s count=$o(^zCacheTemp("VICADISSummary",repid1,"S36",id,count)) q:count=""  d
 . . s S36=$i(S36)
 . . s S37=$i(S37)
 . d file.WriteLine(id_","_S36)
 d file.WriteLine("Total,"_S37)
 d file.Close()
 
 k ^zCacheTemp("VICADISSummary",repid1)
 q 1
]]></Implementation>
</Method>

<Method name="IRISSummary">
<ClassMethod>1</ClassMethod>
<FormalSpec>filepath:%Library.String,date:%Library.String,time:%Library.String</FormalSpec>
<Implementation><![CDATA[
 s repid1=$i(^zCacheTemp("VICIRISSummary"))
 k ^zCacheTemp("VICIRISSummary",repid1)
 
 n S1,S1L,S2,S3,S3L,S3P,S4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,S24,S25,S26,S27,S28,S29,S30,S31,S32,S33,S34,S35,S36,S37,S38,S39,S40,S41,S42,S43,S44,S45,id
 s (S1,S1L,S2,S3,S3L,S3PS4,S5,S6,S7,S8,S9,S10,S11,S12,S13,S14,S15,S16,S17,S18,S19,S20,S21,S22,S23,S24,S25,S26,S27,S28,S29,S30,S31,S32,S33,S34,S35,S36,S37,S38,S39,S40,S41,S42,S43,S44,S45,id)=""
 n S37A,S38A,S39A
 s (S37A,S38A,S39A)=""
 s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="Agency",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S1=$p($g(^Custom.ExtractSummaries(id)),"^",13)
 . . s S1L=$p($g(^Custom.ExtractSummaries(id)),"^",11)
 . . s S1L=$l(S1L)
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="AgencyCase",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
  . . s S2=..GetActualCode("ARC_InsuranceType","INST_Code","IRIS",$p($g(^Custom.ExtractSummaries(id)),"^",12))
 . . i S2'="" s S2=##class(web.ARCInsuranceType).GetIdFromCodeOrDescription(S2)
 . . i S2'="" s S2=$p($g(^ARC("INST",S2)),"^",2)
 . . s ^zCacheTemp("VICIRISSummary",repid1,"S2",S2)=""
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="Activity",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . i '$d(^zCacheTemp("VICIRISSummary",repid1,"S3",$p($g(^Custom.ExtractSummaries(id)),"^",11))) s ^zCacheTemp("VICIRISSummary",repid1,"S3",$p($g(^Custom.ExtractSummaries(id)),"^",11))=0
 . . s ^zCacheTemp("VICIRISSummary",repid1,"S3",$p($g(^Custom.ExtractSummaries(id)),"^",11))=$p($g(^Custom.ExtractSummaries(id)),"^",17)+$g(^zCacheTemp("VICIRISSummary",repid1,"S3",$p($g(^Custom.ExtractSummaries(id)),"^",11)))
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="Case",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S4=..GetActualCode("ARC_AuxilInsurType","AUXIT_Code","IRIS",$p($g(^Custom.ExtractSummaries(id)),"^",13))
 . . i S4'="" s S4=##class(web.ARCAuxilInsurType).GetIdFromCodeOrDescription(S4)
 . . i S4'="" s S4=$p($g(^ARC("AUXIT",S4)),"^",2)
 . . i S4'="" s ^zCacheTemp("VICIRISSummary",repid1,"Case",S4,$p($g(^Custom.ExtractSummaries(id)),"^",10))=""
 . . i '$d(^zCacheTemp("VICIRISSummary",repid1,"S45",$p($g(^Custom.ExtractSummaries(id)),"^",10))) s ^zCacheTemp("VICIRISSummary",repid1,"S45",$p($g(^Custom.ExtractSummaries(id)),"^",10))=0
 . . s ^zCacheTemp("VICIRISSummary",repid1,"S45",$p($g(^Custom.ExtractSummaries(id)),"^",10))=$i(S45)
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="Client",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S33=$i(S33)
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="NSCase",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S34=$i(S34)
 . . s S35=$p($g(^Custom.ExtractSummaries(id)),"^",17)+S35
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="Project",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S37=$p($g(^Custom.ExtractSummaries(id)),"^",17)
 . . i S37'="" s S37=$o(^RBC("SESS",0,"Code",S37,0))
 . . i S37'="" s S37=$p($g(^RBC("SESS",S37)),"^",2)
 . . s S38=$p($g(^Custom.ExtractSummaries(id)),"^",18)
 . . i S38'="" s S38=$o(^RBC("SIGNF",0,"Code",S38,0))
 . . i S38'="" s S38=$p($g(^RBC("SIGNF",S38)),"^",2)
 . . i S37="" s S37="Null"
 . . i S38="" s S38="Null"
 . . s ^zCacheTemp("VICIRISSummary",repid1,"Project",$p($g(^Custom.ExtractSummaries(id)),"^",13),S37,S38)=""
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="Service",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S39=##Class(Custom.VICIRISExtract).GetMappedCode("ARC_ItmMast","ARCIM_Text2","IRISSummary",$p($g(^Custom.ExtractSummaries(id)),"^",13))
 . . i S39="" s S39="Unknown"
 . . i '$d(^zCacheTemp("VICIRISSummary",repid1,"Service",S39)) s ^zCacheTemp("VICIRISSummary",repid1,"Service",S39)=0
 . . s ^zCacheTemp("VICIRISSummary",repid1,"Service",S39)=$p($g(^Custom.ExtractSummaries(id)),"^",17)+$g(^zCacheTemp("VICIRISSummary",repid1,"Service",S39))
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ServiceFamily",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S41=$i(S41)
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ServiceMCH",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S42=$i(S42)
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ServiceSASS",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S43=$i(S43)
 . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="ServiceSCS",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . s S44=$i(S44)
 
 i $f(filepath,"/") s filename=$p(filepath,"/",$l(filepath,"/")-1)_".csv"
 i $f(filepath,"\") s filename=$p(filepath,"\",$l(filepath,"\")-1)_".csv"
 
 s filepath=filepath_"IRIS Summary"_$e(filename,5,$l(filename))
 
 s file=##class(%File).%New(filepath)
 d file.Open("WSN")
 d file.WriteLine("")
 
 d file.WriteLine("IRIS  - EXTRACT SUMMARY REPORT")
 d file.WriteLine(",,IRIS Extract Item Number,IRIS Extract Item")
 d file.WriteLine(",Table: Agency,298,Description,"_S1)
 
 s id=0
 s S2=0 f  s S2=$o(^zCacheTemp("VICIRISSummary",repid1,"S2",S2)) q:S2=""  d
 . i id=0 d file.WriteLine(",Table: Agency Case,303,CaseCode,"_S2)
 . i id'=0 d file.WriteLine(",,,,"_S2)
 . s id=1
 d file.WriteLine("")
 
 s (id,S4,S5)=0
 s S3=0 f  s S3=$o(^zCacheTemp("VICIRISSummary",repid1,"S3",S3)) q:S3=""  d
 . i id=0 d
 . . s S3L=$l(S3)
 . . s S3P= $E(S3,S1L+1,S3L) d
 . . d file.WriteLine(",Table: Activity,8,Duration,"_$p($g(^RBC("EQ",S3P)),"^",2)_","_$g(^zCacheTemp("VICIRISSummary",repid1,"S3",S3)))
 . . s S5=$g(^zCacheTemp("VICIRISSummary",repid1,"S3",S3))+S5 
 . i id'=0 d
 . . s S3P= $E(S3,S1L+1,S3L) d
 . . d file.WriteLine(",,,,"_$p($g(^RBC("EQ",S3P)),"^",2)_","_$g(^zCacheTemp("VICIRISSummary",repid1,"S3",S3)))
 . . s S5=$g(^zCacheTemp("VICIRISSummary",repid1,"S3",S3))+S5
 . s id=1
 d file.WriteLine(",,,,Total,"_S5)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseFamily,13,oid,Count of Clients by Case Type/ Funding Source,,")
 s S6=0 f  s S6=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S6)) q:S6=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseFamily",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S6,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S7=$i(S7)
 . s S8=S8+S7
 . i S7'="" d
 . . i S7'=0 d file.WriteLine(",,,,"_S6_","_S7)
 . s S7=0
 d file.WriteLine(",,,,Total,"_S8)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseFinancial,21,oid,Count of Clients by Case Type/ Funding Source,,")
 s S9=0 f  s S9=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S9)) q:S9=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseFinancial",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S9,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S10=$i(S10)
 . s S11=S11+S10
 . i S10'="" d
 . . i S10'=0 d file.WriteLine(",,,,"_S9_","_S10)
 . s S10=0
 d file.WriteLine(",,,,Total,"_S11)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseFVS,37,oid,Count of Clients by Case Type/ Funding Source,,")
 s S12=0 f  s S12=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S12)) q:S12=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseFVS",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S12,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S13=$i(S13)
 . s S14=S14+S13
 . i S13'="" d
 . . i S13'=0 d file.WriteLine(",,,,"_S12_","_S13)
 . s S13=0
 d file.WriteLine(",,,,Total,"_S14)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseGambling,52,oid,Count of Clients by Case Type/ Funding Source,,")
 s S15=0 f  s S15=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S15)) q:S15=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseGambling",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S15,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S16=$i(S16)
 . s S17=S17+S16
 . i S16'="" d
 . . i S16'=0 d file.WriteLine(",,,,"_S15_","_S16)
 . s S16=0
 d file.WriteLine(",,,,Total,"_S17)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseLN,73,Oid,Count of Clients by Case Type/ Funding Source,,")
 s S18=0 f  s S18=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S18)) q:S18=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseLN",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S18,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S19=$i(S19)
 . s S20=S20+S19
 . i S19'="" d
 . . i S19'=0 d file.WriteLine(",,,,"_S18_","_S19)
 . s S19=0
 d file.WriteLine(",,,,Total,"_S20)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseMCH,107,oid,Count of Clients by Case Type/ Funding Source,,")
 s S21=0 f  s S21=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S21)) q:S21=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseMCH",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S21,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S22=$i(S22)
 . s S23=S23+S22
 . i S22'="" d
 . . i S22'=0 d file.WriteLine(",,,,"_S21_","_S22)
 . s S22=0
 d file.WriteLine(",,,,Total,"_S23)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CasePSFO,113,oid,Count of Clients by Case Type/ Funding Source,,")
 s S24=0 f  s S24=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S24)) q:S24=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CasePSFO",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S24,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S25=$i(S25)
 . s S26=S26+S25
 . i S25'="" d
 . . i S25'=0 d file.WriteLine(",,,,"_S24_","_S25)
 . s S25=0
 d file.WriteLine(",,,,Total,"_S26)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: Cases,132,oid,Count of Clients,"_S45)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseSASS,145,oid,Count of Clients by Case Type/ Funding Source,,")
 s S27=0 f  s S27=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S27)) q:S27=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseSASS",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S27,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S28=$i(S28)
 . s S29=S29+S28
 . i S28'="" d
 . . i S28'=0 d file.WriteLine(",,,,"_S27_","_S28)
 . s S28=0
 d file.WriteLine(",,,,Total,"_S29)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: CaseSCS,161,oid,Count of Clients by Case Type/ Funding Source,,")
 s S30=0 f  s S30=$o(^zCacheTemp("VICIRISSummary",repid1,"Case",S30)) q:S30=""  d
 . s id=0 f  s id=$o(^Custom.ExtractSummaries(0,"TypeDateTime","IRIS",date,time,id)) q:id=""  d
 . . i $p($g(^Custom.ExtractSummaries(id)),"^",5)="CaseSCS",$p($g(^Custom.ExtractSummaries(id)),"^",10)'="oid" d
 . . . i $d(^zCacheTemp("VICIRISSummary",repid1,"Case",S30,$p($g(^Custom.ExtractSummaries(id)),"^",10))) s S31=$i(S31)
 . s S32=S32+S31
 . i S31'="" d
 . . i S31'=0 d file.WriteLine(",,,,"_S30_","_S31)
 . s S31=0
 d file.WriteLine(",,,,Total,"_S32)
 d file.WriteLine("")
 
 d file.WriteLine(",Table: Client,193,oid,Count of Total Clients,"_S33)
 d file.WriteLine("")
 d file.WriteLine(",Table: NSCase,235,oid,Total Non Substantiated Cases,"_S34)
 d file.WriteLine(",,242,Duration,Total Non Substantiated Hours,"_S35)
 d file.WriteLine("")
 d file.WriteLine(",Table: Project,251,Name,Name,CaseTypeCode,SourceOfFundingCode")
 s id=0
 s S36=0 f  s S36=$o(^zCacheTemp("VICIRISSummary",repid1,"Project",S36)) q:S36=""  d
 . s S37=0 f  s S37=$o(^zCacheTemp("VICIRISSummary",repid1,"Project",S36,S37)) q:S37=""  d
 . . s S38=0 f  s S38=$o(^zCacheTemp("VICIRISSummary",repid1,"Project",S36,S37,S38)) q:S38=""  d
 . . . i S37="Null" { s S37A="" } else { s S37A=S37 }
 . . . i S38="Null" { s S38A="" } else { s S38A=S38 }
 . . . i id=0 d file.WriteLine(",,255,CaseTypeCode,"_S36_","_S37A_","_S38A)
 . . . i id=1 d file.WriteLine(",,256,SourceOfFundingCode,"_S36_","_S37A_","_S38A)
 . . . i id>=2 d file.WriteLine(",,,,"_S36_","_S37A_","_S38A)
 . . . s id=$i(id)
 i id=0 d file.WriteLine(",,255,CaseTypeCode")
 i id=1 d file.WriteLine(",,256,SourceOfFundingCode")
 d file.WriteLine("")
 
 d file.WriteLine(",Table: Service,272,ServiceTypeCode,Total Hours (Duration) by Service Type Code,,")
 s S39=0 f  s S39=$o(^zCacheTemp("VICIRISSummary",repid1,"Service",S39)) q:S39=""  d
 . i S39="Unknown" { s S39A="" } else { s S39A=S39 }
 . d file.WriteLine(",,,,"_S39A_","_$g(^zCacheTemp("VICIRISSummary",repid1,"Service",S39)))
 d file.WriteLine("")
 i $g(S41)="" s S41=0
 i $g(S42)="" s S42=0
 i $g(S43)="" s S43=0
 i $g(S44)="" s S44=0
 d file.WriteLine(",Table: ServiceFamily,280,oid,Count of Clients,"_S41)
 d file.WriteLine(",Table: ServiceMCH,286,oid,Count of Clients,"_S42)
 d file.WriteLine(",Table: ServiceSASS,289,oid,Count of Clients,"_S43)
 d file.WriteLine(",Table: ServiceSCS,292,oid,Count of Clients,"_S44)

 d file.Close()
 
 k ^zCacheTemp("VICIRISSummary",repid1)
 q 1
]]></Implementation>
</Method>
</Class>
</Export>
